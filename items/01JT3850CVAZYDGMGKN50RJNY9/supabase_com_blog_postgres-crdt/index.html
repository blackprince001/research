<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon-precomposed" sizes="57x57" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0006%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="60x60" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0007%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="72x72" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0008%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="76x76" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0009%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="114x114" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0010%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="120x120" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0011%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="144x144" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0012%2Epng"/><link rel="apple-touch-icon-precomposed" sizes="152x152" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0013%2Epng"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0014%2Epng" sizes="16x16"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0015%2Epng" sizes="32x32"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0016%2Epng" sizes="48x48"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0017%2Epng" sizes="96x96"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0018%2Epng" sizes="128x128"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0019%2Epng" sizes="180x180"/><link rel="icon" type="image/png" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0020%2Epng" sizes="196x196"/><meta name="application-name" content="Supabase"/><meta name="msapplication-TileColor" content="#1E1E1E"/><meta name="msapplication-TileImage" content="/favicon/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="/favicon/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="/favicon/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="/favicon/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="/favicon/mstile-310x310.png"/><meta name="theme-color" content="#1E1E1E"/><link rel="shortcut icon" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0021%2Eico"/><link rel="icon" type="image/x-icon" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0021%2Eico"/><link rel="apple-touch-icon" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0021%2Eico"/><link rel="alternate" type="application/rss+xml" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0022%2Exml"/><link rel="manifest" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0023%2Ejson"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@supabase"/><meta name="twitter:creator" content="@supabase"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:site_name" content="Supabase"/><title>pg_crdt - an experimental CRDT extension for Postgres</title><meta name="robots" content="index,follow"/><meta name="description" content="Embedding Yjs and Automerge into Postgres for collaborative applications."/><meta property="og:title" content="pg_crdt - an experimental CRDT extension for Postgres"/><meta property="og:description" content="Embedding Yjs and Automerge into Postgres for collaborative applications."/><meta property="og:url" content="https://supabase.com/blog/postgres-crdt"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2022-12-10"/><meta property="article:author" content="https://github.com/kiwicopple"/><meta property="article:tag" content="launch-week"/><meta property="article:tag" content="postgres"/><meta property="article:tag" content="planetpg"/><meta property="og:image" content="https://supabase.com/images/blog/launch-week-6/crdt/og-pg-crdt.png"/><meta property="og:image:alt" content="pg_crdt - an experimental CRDT extension for Postgres thumbnail"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--light.daaeffd3.png&amp;w=128&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 1x, /_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--light.daaeffd3.png&amp;w=256&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 2x" fetchpriority="high"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--dark.b36ebb5f.png&amp;w=128&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 1x, /_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--dark.b36ebb5f.png&amp;w=256&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 2x" fetchpriority="high"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--light.daaeffd3.png&amp;w=256&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 1x, /_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--light.daaeffd3.png&amp;w=384&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 2x" fetchpriority="high"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--dark.b36ebb5f.png&amp;w=256&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 1x, /_next/image?url=https%3A%2F%2Ffrontend-assets.supabase.com%2Fwww%2Fa343e864a02b%2F_next%2Fstatic%2Fmedia%2Fsupabase-logo-wordmark--dark.b36ebb5f.png&amp;w=384&amp;q=75&amp;dpl=dpl_4PTCgumi5w7tgv2j4qrU9SFC9HQ6 2x" fetchpriority="high"/><meta name="next-head-count" content="55"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0024%2Ecss%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" as="style"/><link rel="stylesheet" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0024%2Ecss%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" data-n-g=""/><link rel="preload" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0025%2Ecss%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" as="style"/><link rel="stylesheet" href="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0025%2Ecss%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0026%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0027%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0028%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0029%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0030%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0031%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0032%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0033%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0034%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0035%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0036%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0037%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0038%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0039%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0040%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0041%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0042%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0043%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0044%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0045%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0046%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0047%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0048%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0049%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0050%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0051%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0052%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script><script src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0053%2Ejs%3Fdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6" defer=""></script></head><body><div id="__next"><script type="application/json" data-flag-values="true">{}</script><script>!function(){try{var d=document.documentElement,n='data-theme',s='setAttribute';var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';d[s](n,'dark')}else{d.style.colorScheme = 'light';d[s](n,'light')}}else if(e){d[s](n,e|| '')}else{d[s](n,'dark')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'dark'}catch(e){}}()</script><div class="sticky top-0 z-40 transform" style="transform:translate3d(0,0,999px)"><div class="absolute inset-0 h-full w-full bg-background/90 dark:bg-background/95 !opacity-100 transition-opacity"></div><nav class="relative z-40 border-default border-b backdrop-blur-sm transition-opacity"><div class="relative flex justify-between h-16 mx-auto lg:container lg:px-16 xl:px-20"><div class="flex items-center px-6 lg:px-0 flex-1 sm:items-stretch justify-between"><div class="flex items-center"><div class="flex items-center flex-shrink-0"><a class="block w-auto h-6 focus-visible:ring-2 focus-visible:outline-none focus-visible:ring-foreground-lighter focus-visible:ring-offset-4 focus-visible:ring-offset-background-alternative focus-visible:rounded-sm" type="button" id="radix-:Ramcla6:" aria-haspopup="menu" aria-expanded="false" data-state="closed" data-original-href="/"data-href-disabled><img alt="Supabase Logo" fetchpriority="high" width="124" height="24" decoding="async" data-nimg="1" class="dark:hidden" style="color:transparent" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0000%2Epng%26amp%3Bw%3D256%26amp%3Bq%3D75%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/><img alt="Supabase Logo" fetchpriority="high" width="124" height="24" decoding="async" data-nimg="1" class="hidden dark:block" style="color:transparent" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0001%2Epng%26amp%3Bw%3D256%26amp%3Bq%3D75%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/></a></div><nav aria-label="Main" data-orientation="horizontal" dir="ltr" class="relative z-10 flex-1 items-center justify-center hidden pl-8 sm:space-x-4 lg:flex h-16"><div style="position:relative"><ul data-orientation="horizontal" class="group flex flex-1 list-none items-center justify-center space-x-1" dir="ltr"><li class="text-sm font-medium"><button id="radix-:Rimcla6:-trigger-radix-:Rbimcla6:" data-state="closed" aria-expanded="false" aria-controls="radix-:Rimcla6:-content-radix-:Rbimcla6:" class="group relative justify-center cursor-pointer inline-flex items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border text-foreground hover:bg-surface-300 shadow-none focus-visible:outline-border-strong data-[state=open]:bg-surface-300 data-[state=open]:outline-border-strong border-transparent text-sm leading-4 py-2 !bg-transparent hover:text-brand-link data-[state=open]:!text-brand-link data-[radix-collection-item]:focus-visible:ring-2 data-[radix-collection-item]:focus-visible:ring-foreground-lighter data-[radix-collection-item]:focus-visible:text-foreground px-2 h-auto" data-radix-collection-item="">Product<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button></li><li class="text-sm font-medium"><button id="radix-:Rimcla6:-trigger-radix-:Rjimcla6:" data-state="closed" aria-expanded="false" aria-controls="radix-:Rimcla6:-content-radix-:Rjimcla6:" class="group relative justify-center cursor-pointer inline-flex items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border text-foreground hover:bg-surface-300 shadow-none focus-visible:outline-border-strong data-[state=open]:bg-surface-300 data-[state=open]:outline-border-strong border-transparent text-sm leading-4 py-2 !bg-transparent hover:text-brand-link data-[state=open]:!text-brand-link data-[radix-collection-item]:focus-visible:ring-2 data-[radix-collection-item]:focus-visible:ring-foreground-lighter data-[radix-collection-item]:focus-visible:text-foreground px-2 h-auto" data-radix-collection-item="">Developers<!-- --> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180" aria-hidden="true"><path d="m6 9 6 6 6-6"></path></svg></button></li><li class="text-sm font-medium"><a class="group/menu-item flex items-center text-sm hover:text-foreground select-none gap-3 rounded-md p-2 leading-none no-underline outline-none focus-visible:ring-2 focus-visible:ring-foreground-lighter group-hover:bg-transparent text-foreground focus-visible:text-brand-link" data-radix-collection-item="" data-original-href="/enterprise"data-href-disabled><div class="flex flex-col justify-center"><div class="flex items-center gap-1"><p class="leading-snug text-foreground group-hover/menu-item:text-brand-link">Enterprise</p></div></div></a></li><li class="text-sm font-medium"><a class="group/menu-item flex items-center text-sm hover:text-foreground select-none gap-3 rounded-md p-2 leading-none no-underline outline-none focus-visible:ring-2 focus-visible:ring-foreground-lighter group-hover:bg-transparent text-foreground focus-visible:text-brand-link" data-radix-collection-item="" data-original-href="/pricing"data-href-disabled><div class="flex flex-col justify-center"><div class="flex items-center gap-1"><p class="leading-snug text-foreground group-hover/menu-item:text-brand-link">Pricing</p></div></div></a></li><li class="text-sm font-medium"><a class="group/menu-item flex items-center text-sm hover:text-foreground select-none gap-3 rounded-md p-2 leading-none no-underline outline-none focus-visible:ring-2 focus-visible:ring-foreground-lighter group-hover:bg-transparent text-foreground focus-visible:text-brand-link" data-radix-collection-item="" data-original-href="/docs"data-href-disabled><div class="flex flex-col justify-center"><div class="flex items-center gap-1"><p class="leading-snug text-foreground group-hover/menu-item:text-brand-link">Docs</p></div></div></a></li><li class="text-sm font-medium"><a class="group/menu-item flex items-center text-sm hover:text-foreground select-none gap-3 rounded-md p-2 leading-none no-underline outline-none focus-visible:ring-2 focus-visible:ring-foreground-lighter group-hover:bg-transparent text-foreground focus-visible:text-brand-link" data-radix-collection-item="" data-original-href="/blog"data-href-disabled><div class="flex flex-col justify-center"><div class="flex items-center gap-1"><p class="leading-snug text-foreground group-hover/menu-item:text-brand-link">Blog</p></div></div></a></li></ul></div><div class="absolute left-0 top-full flex justify-center"></div></nav></div><div class="flex items-center gap-2 opacity-0 animate-fade-in !scale-100 delay-300"><a data-original-href="https://github.com/supabase/supabase" target="_blank" data-size="tiny" class="relative justify-center cursor-pointer items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border hover:bg-surface-300 shadow-none focus-visible:outline-border-strong data-[state=open]:bg-surface-300 data-[state=open]:outline-border-strong border-transparent text-xs px-2.5 py-1 h-[26px] hidden group lg:flex text-foreground-light hover:text-foreground"data-href-disabled><span class="truncate"><span class="flex items-center gap-1"><svg class="w-6 h-6" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.5 2.22168C5.23312 2.22168 2.58496 4.87398 2.58496 8.14677C2.58496 10.7642 4.27962 12.9853 6.63026 13.7684C6.92601 13.8228 7.03366 13.6401 7.03366 13.4827C7.03366 13.3425 7.02893 12.9693 7.02597 12.4754C5.38041 12.8333 5.0332 11.681 5.0332 11.681C4.76465 10.996 4.37663 10.8139 4.37663 10.8139C3.83954 10.4471 4.41744 10.4542 4.41744 10.4542C5.01072 10.4956 5.32303 11.0647 5.32303 11.0647C5.85065 11.9697 6.70774 11.7082 7.04431 11.5568C7.09873 11.1741 7.25134 10.9132 7.42051 10.7654C6.10737 10.6157 4.72621 10.107 4.72621 7.83683C4.72621 7.19031 4.95689 6.66092 5.33486 6.24686C5.27394 6.09721 5.07105 5.49447 5.39283 4.67938C5.39283 4.67938 5.88969 4.51967 7.01947 5.28626C7.502 5.15466 7.99985 5.08763 8.5 5.08692C9.00278 5.08929 9.50851 5.15495 9.98113 5.28626C11.1103 4.51967 11.606 4.67879 11.606 4.67879C11.9289 5.49447 11.7255 6.09721 11.6651 6.24686C12.0437 6.66092 12.2732 7.19031 12.2732 7.83683C12.2732 10.1129 10.8897 10.6139 9.5724 10.7606C9.78475 10.9434 9.97344 11.3048 9.97344 11.8579C9.97344 12.6493 9.96634 13.2887 9.96634 13.4827C9.96634 13.6413 10.0728 13.8258 10.3733 13.7678C11.5512 13.3728 12.5751 12.6175 13.3003 11.6089C14.0256 10.6002 14.4155 9.38912 14.415 8.14677C14.415 4.87398 11.7663 2.22168 8.5 2.22168Z" fill="currentColor"></path></svg>81.8K</span></span></a><a data-size="tiny" type="button" class="relative justify-center cursor-pointer items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border text-foreground bg-alternative dark:bg-muted hover:bg-selection border-strong hover:border-stronger focus-visible:outline-brand-600 data-[state=open]:bg-selection data-[state=open]:outline-brand-600 data-[state=open]:border-button-hover text-xs px-2.5 py-1 h-[26px] hidden lg:block" data-original-href="https://supabase.com/dashboard"data-href-disabled><span class="truncate">Sign in</span></a><a data-size="tiny" type="button" class="relative justify-center cursor-pointer items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border bg-brand-400 dark:bg-brand-500 hover:bg-brand/80 dark:hover:bg-brand/50 text-foreground border-brand-500/75 dark:border-brand/30 hover:border-brand-600 dark:hover:border-brand focus-visible:outline-brand-600 data-[state=open]:bg-brand-400/80 dark:data-[state=open]:bg-brand-500/80 data-[state=open]:outline-brand-600 text-xs px-2.5 py-1 h-[26px] hidden lg:block" data-original-href="https://supabase.com/dashboard"data-href-disabled><span class="truncate">Start your project</span></a></div></div><div class="inset-y-0 flex mr-2 items-center px-4 lg:hidden"><button class="text-foreground-lighter focus:ring-brand bg-transparent hover:text-foreground-light transition-colors hover:bg-overlay inline-flex items-center justify-center rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-inset" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="block w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg><svg class="hidden w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div></nav><div class="h-[2px] w-full flex justify-start relative"><div class="h-full top-0 bottom-0 right-0 absolute w-screen bg-brand will-change-transform transition-opacity" style="display:absolute;transform:translate3d(-100%,0,0);opacity:1"></div></div></div><main class="relative min-h-screen overflow-x-hidden"><div class=" container mx-auto px-4 py-4 md:py-8 xl:py-10 sm:px-16 xl:px-20 "><div class="grid grid-cols-12 gap-4"><div class="hidden col-span-12 xl:block lg:col-span-2"><a class="text-foreground-lighter hover:text-foreground flex cursor-pointer items-center text-sm transition" data-original-href="/blog"data-href-disabled><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left" style="padding:0"><path d="m15 18-6-6 6-6"></path></svg>Back</a></div><div class="col-span-12 lg:col-span-12 xl:col-span-10"><div class="mb-6 lg:mb-10 max-w-5xl space-y-8"><div class="space-y-4"><a class="text-brand hidden lg:inline" data-original-href="/blog"data-href-disabled>Blog</a><h1 class="text-2xl sm:text-4xl">pg_crdt - an experimental CRDT extension for Postgres</h1><div class="text-light flex space-x-3 text-sm"><p>10 Dec 2022</p><p>•</p><p>9 minute read</p></div><div class="hidden lg:flex justify-between"><div class="flex-1 flex flex-col gap-3 pt-2 md:flex-row md:gap-0 lg:gap-3"><div class="mr-4 w-max"><a target="_blank" class="cursor-pointer" data-original-href="https://github.com/kiwicopple"data-href-disabled><div class="flex items-center gap-3"><div class="w-10"><img alt="Paul Copplestone avatar" loading="lazy" width="40" height="40" decoding="async" data-nimg="1" class="border-default rounded-full border w-full aspect-square object-cover" style="color:transparent" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0002%2Epng%26amp%3Bw%3D96%26amp%3Bq%3D75%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/></div><div class="flex flex-col"><span class="text-foreground mb-0 text-sm">Paul Copplestone</span><span class="text-foreground-lighter mb-0 text-xs">CEO and Co-Founder</span></div></div></a></div></div></div></div></div><div class="grid grid-cols-12 lg:gap-16 xl:gap-8"><div class="col-span-12 lg:col-span-7 xl:col-span-7"><article><div class="prose prose-docs"><div class="hidden md:block relative mb-8 w-full aspect-video overflow-auto rounded-lg border"><img alt="pg_crdt - an experimental CRDT extension for Postgres" loading="lazy" decoding="async" data-nimg="fill" class="object-cover m-0" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0003%2Epng%26amp%3Bw%3D3840%26amp%3Bq%3D100%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/></div><style>[data-ch-theme="supabase"] {  --ch-t-colorScheme: var(--ch-0);--ch-t-foreground: var(--ch-4);--ch-t-background: var(--ch-16);--ch-t-editor-background: var(--ch-16);--ch-t-editor-foreground: var(--ch-4);--ch-t-editor-rangeHighlightBackground: var(--ch-19);--ch-t-editor-infoForeground: var(--ch-18);--ch-t-editor-selectionBackground: var(--ch-17);--ch-t-tab-activeBackground: var(--ch-16);--ch-t-tab-activeForeground: var(--ch-4);--ch-t-tab-inactiveBackground: var(--ch-21);--ch-t-tab-inactiveForeground: var(--ch-15);--ch-t-tab-border: var(--ch-22);--ch-t-tab-activeBorder: var(--ch-16);--ch-t-editorGroupHeader-tabsBackground: var(--ch-21);--ch-t-editorLineNumber-foreground: var(--ch-20);--ch-t-input-foreground: var(--ch-4);--ch-t-sideBar-foreground: var(--ch-4);--ch-t-list-hoverBackground: var(--ch-25);--ch-t-list-hoverForeground: var(--ch-4); }</style>
<p>Today we&#x27;re open-sourcing an EXPERIMENTAL extension for CRDTs, <code class="short-inline-codeblock">pg_crdt</code>. The GitHub repo is <a data-original-href="https://github.com/supabase/pg_crdt"data-href-disabled>here</a>. There are <a data-original-href="https://github.com/supabase/pg_crdt#installation"data-href-disabled>instructions</a> for running it locally in the README.</p>
<p>When we released the new <a data-original-href="/blog/supabase-realtime-multiplayer-general-availability"data-href-disabled>multiplayer features</a> for our Realtime engine,
it took 30 minutes for someone to ask if we&#x27;d add CRDT support.</p>
<blockquote>
<p><em>Anyone from Supabase here, do you have any plans to build in support for CRDT toolkits such as Yjs or AutoMerge for these features? It would make working with them so much easier if there was a plug and play backend.</em></p>
</blockquote>
<small><i>@samwillis on <a data-original-href="https://news.ycombinator.com/item?id=32510820"data-href-disabled>HackerNews</a></i></small>
<p>pg_crdt has not been released onto the Supabase platform (and it may never be). We&#x27;re considering many options for offline-sync/support and, while CRDTs will undoubtedly factor in, we&#x27;re not sure if this is the right approach. Hopefully this release generates a healthy discussion about the various ways we can do it at Supabase.</p>
<h2 id="whats-a-crdt" class="group scroll-mt-24">What&#x27;s a CRDT?<a data-original-href="#whats-a-crdt" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p>A CRDT (Conflict-free Replicated Data Type) is a data structure. More accurately, a family of data structures. They enable collaborative apps like <a data-original-href="https://www.figma.com/blog/how-figmas-multiplayer-technology-works/"data-href-disabled>Figma</a>.</p>
<p>You already know what a “data structure” is: an Array is a good example. CRDTs are a <em>special</em> type of data structure designed to solve a specific problem: they can merge changes in a way that the final state of the data will be the same, no matter the order in which the updates were applied.</p>
<p>In simple terms, a CRDT allows multiple users to make changes to the same data without the need for a central authority to coordinate their actions.</p>
<p>Let&#x27;s use our Array example to demonstrate the problem they solve. Imagine you have an array (which is not a CRDT):</p>
<div class="ch-codeblock not-prose "><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br/><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>let fruit = [&#x27;Apple&#x27;, &#x27;Banana&#x27;, &#x27;Orange&#x27;]</span></div></div><br/></code></div></div>
<p>Now imagine you have 2 developers updating this array on their local computers. They both want to replace the fruit at the start of the array. The first user, let&#x27;s call her “Jenny”, does this:</p>
<div class="ch-codeblock not-prose "><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br/><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fruit[0] = &#x27;Grape&#x27; // the array is [&#x27;Grape&#x27;, &#x27;Banana&#x27;, &#x27;Orange&#x27;]</span></div></div><br/></code></div></div>
<p>The developer sitting next to her, let&#x27;s call him “Jonny”, does the same:</p>
<div class="ch-codeblock not-prose "><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br/><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fruit[0] = &#x27;Mango&#x27; // the array is [&#x27;Mango&#x27;, &#x27;Banana&#x27;, &#x27;Orange&#x27;]</span></div></div><br/></code></div></div>
<p>And now, since they are both developing on different machines, they push their changes to a remote server. When the updates land on the remote system, what will <code class="short-inline-codeblock">fruit[0]</code> be? “Grape” or “Mango”?</p>
<p></p>
<p>Since this is one of those <em>basic</em> arrays, the answer is &quot;the fruit array that arrives last”.</p>
<ol>
<li>If Jonny&#x27;s fruit array arrives first, it will be saved.</li>
<li>After that, Jenny&#x27;s fruit arrived and overwrites Jonny&#x27;s changes.</li>
</ol>
<p>But therein lies the problem: Jonny was the last developer to change his array of fruit, shouldn&#x27;t his changes be the ones that are saved?</p>
<p>That&#x27;s one of the things that CRDTs solve. There is an “array CRDT” which, when merged, will always have the same result. It doesn&#x27;t matter if Jonny&#x27;s array arrives first, or if Jenny&#x27;s arrives first - every time you merge them they would be able to determine that the Jonny&#x27;s was the last change the fruit array.</p>
<p>How does it do that? Some sort of algorithm, but you can ask ChatGPT to explain that one.</p>
<h2 id="offline-philosophy" class="group scroll-mt-24">Offline philosophy<a data-original-href="#offline-philosophy" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p>Collaborative apps are becoming more prolific as legacy software is rebuilt within a browser environment.</p>
<p>Collaboration is largely a data problem - how do we get one user&#x27;s changes (data) to merge with another user&#x27;s changes (data)? As a database provider it&#x27;s natural fit for Supabase to provide the tooling for developers to build collaborative apps.</p>
<p>Before going too far down the “solution” rabbit hole at Supabase, we try to think about the long-term implications of adopting any technology. We&#x27;re pretty boring - we don&#x27;t make bets on technologies unless we think they will exist in 20 years.</p>
<p>I personally believe CRDTs are the future. For <em>some things</em>. If databases were invented today, I&#x27;m certain most of the effort would be spent developing CRDT databases or something with “offline algorithms” built-in. But tech is a real-world demonstration of the Lindy effect: the longer something has existed, the longer it&#x27;s likely to exist in the future. That&#x27;s why we bet on Postgres - with more than 30 years history, it&#x27;s here to stay.</p>
<p>Faced with this reality, we should consider how to solve <em>offline with Postgres</em> and where CRDTs might fit into that picture.</p>
<p>For a long time I thought there could be a way to shoehorn Postgres row-level data into a CRDT, to give <em>truly</em> offline support. This may even still be <a data-original-href="https://electric-sql.com/"data-href-disabled>possible</a>, and it&#x27;s one of the ideas we&#x27;ll continue to pursue. But Postgres is a rich and evolving ecosystem, and I don&#x27;t know whether it will be possible to -</p>
<p>a) find a merge strategy for an entire row, while simultaneously:</p>
<p>b) finding a merge strategy for every data type <em>within</em> that row (especially with the number of data types available through extensions)</p>
<p>It&#x27;s possible that developers will need to be selective about their “level” of offline support, at least if they plan to use an “incumbent” databases. For the cases, a simple “last write wins” strategy is probably acceptable (see the excellent <a data-original-href="https://doc.replicache.dev/examples/repliear"data-href-disabled>Replicache</a> and <a data-original-href="https://nozbe.github.io/WatermelonDB/"data-href-disabled>Watermelon</a> libraries), but there will be important pieces of their application where it is not.</p>
<p>Take this table of blog posts as an example:</p>
<div class="ch-codeblock not-prose "><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br/><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>create table posts (</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  id serial primary key,</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  title text,</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  content text default &#x27;&#x27;</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>);</span></div></div><br/></code></div></div>
<p>Perhaps it&#x27;s not that important if the <code class="short-inline-codeblock">title</code> has a “last write wins” strategy, because it&#x27;s rarely updated and less likely to have a merge conflict. But it is critical to use a smarter algorithm for the <code class="short-inline-codeblock">content</code> of the blog post, especially in a team where multiple users are editing a blog post at the same time.</p>
<p>That&#x27;s a lot of background to get to what you probably want to know about:</p>
<h2 id="postgres-crdt-extension" class="group scroll-mt-24">Postgres CRDT extension<a data-original-href="#postgres-crdt-extension" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p><code class="short-inline-codeblock">pg_crdt</code> is an extension which adds CRDT support to Postgres as a data type. For example, using our table from above:</p>
<div class="ch-codeblock not-prose "><div class="ch-code-wrapper ch-code" data-ch-measured="false"><code class="ch-code-scroll-parent"><br/><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>create table posts (</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  id serial primary key,</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  title text,</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>  content crdt.ydoc default crdt.new_ydoc()</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>);</span></div></div><br/></code></div></div>
<p>The <code class="short-inline-codeblock">content</code> column is now a <a data-original-href="https://docs.yjs.dev/api/y.doc"data-href-disabled>Yjs Doc</a>. Updates to this column are <em>commutative</em> and <em>idempotent</em>. This means that they can be applied in any order and multiple times, and the result will always be the same. Two people can edit the blog content at the same time, and they won&#x27;t have any issues when their changes are saved in the database.</p>
<h3 id="support-for-yjs-automerge-and-beyond" class="group scroll-mt-24">Support for Yjs, Automerge, and beyond<a data-original-href="#support-for-yjs-automerge-and-beyond" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h3>
<p>The Yjs and Automerge teams have done some excellent work to create Rust libraries for their CRDTs implementations. It was relatively trivial to wrap the libraries into a Postgres extension using the <a data-original-href="https://github.com/tcdi/pgx"data-href-disabled>pgx</a> framework.</p>
<p>At this stage it makes sense to give developers as many choices as possible in one extension. The CRDT space is nascent the algorithms are rapidly changing.</p>
<p>Importantly, both Yjs and Automerge have <em>JavaScript</em> and Rust implementations, which means they work natively in both a browser and a Postgres environment. Since collaborative applications are largely a client-side problem, CRDTs are more useful for developers if they have robust JavaScript libraries. In the future, if this extension becomes the approach we take, then Supabase will focus some resources on building Yjs/Automerge libraries for mobile devices too (Swift for iOS, Kotlin for Android).</p>
<h2 id="why-not-build-this-into-realtime" class="group scroll-mt-24">Why not build this into Realtime?<a data-original-href="#why-not-build-this-into-realtime" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p>An alternative approach for CRDT support in Supabase is to build support directly into <a data-original-href="https://github.com/supabase/realtime"data-href-disabled>Realtime</a> and use it as an Authoritative server. In this scenario, Realtime would serialize the CRDT and save it to Postgres (probably as a <code class="short-inline-codeblock">bytea</code> data type). Yjs has the concept of <a data-original-href="https://github.com/yjs/yjs#providers"data-href-disabled>Providers</a> which would facilitate this. You can see the difference between the approaches in the diagram below - on the left, Realtime acts as the “middleman” for saving the CRDT in the database, whereas on the right the CRDT is pushed directly to the database, and Realtime receives updates from Postgres. (Note also that clients can send peer-to-peer updates.)</p>
<p></p>
<p>This might still be our best option, but it should not be our first attempt. If we make Realtime the authority, it strongly couples developers to the Supabase infrastructure. By placing the CRDT into the database, it simplifies the architecture, enables other tools (like Debezium), and provides the possibility to update the database directly (for semi-realtime events like counters or page-views).</p>
<p></p>
<p>The Realtime engine seems like a great <em>compliment</em> for <code class="short-inline-codeblock">pg_crdt</code>, but before we put it into production we need to solve a few (major) limitations.</p>
<h2 id="limitations" class="group scroll-mt-24">Limitations<a data-original-href="#limitations" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p>These are a few of the <em>known</em> limitations:</p>
<ul>
<li>Realtime broadcasts database changes from the Postgres write ahead log (WAL). The WAL includes a complete copy of the the underlying data so small updates cause the entire document to broadcast to all collaborators</li>
<li>Frequently updated CRDTs produce a lot of WAL and dead tuples</li>
<li>Large CRDT types in Postgres generate significant serialization/deserialization overhead on-update.</li>
</ul>
<p>We&#x27;re likely to discover more (no doubt from a few friendly HN comments).</p>
<h2 id="next-steps" class="group scroll-mt-24">Next steps<a data-original-href="#next-steps" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<p>If you want to help with <code class="short-inline-codeblock">pg_crdt</code> the best way is to get involved in the GitHub repo. We have enabled <a data-original-href="https://github.com/supabase/pg_crdt/discussions"data-href-disabled>Discussions</a> for any and all ideas. If you have experience with CRDTs and you like this approach, don&#x27;t hesitate to contact one of the team.</p>
<h2 id="more-launch-week-6" class="group scroll-mt-24">More Launch Week 6<a data-original-href="#more-launch-week-6" aria-hidden="true" class="ml-2 opacity-0 group-hover:opacity-100 transition"data-href-disabled><span aria-hidden="true">#</span></a></h2>
<ul>
<li><a data-original-href="https://supabase.com/blog/new-supabase-docs-built-with-nextjs"data-href-disabled>Day 1: New Supabase Docs, built with Next.js</a></li>
<li><a data-original-href="https://supabase.com/blog/storage-image-resizing-smart-cdn"data-href-disabled>Day 2: Supabase Storage v2: Image resizing and Smart CDN</a></li>
<li><a data-original-href="https://supabase.com/blog/mfa-auth-via-rls"data-href-disabled>Day 3: Multi-factor Authentication via Row Level Security Enforcement</a></li>
<li><a data-original-href="https://supabase.com/blog/postgres-foreign-data-wrappers-rust"data-href-disabled>Day 4: Supabase Wrappers, a Postgres FDW framework written in Rust</a></li>
<li><a data-original-href="https://supabase.com/blog/vault-now-in-beta"data-href-disabled>Day 5: Supabase Vault is now in Beta</a></li>
<li><a data-original-href="https://supabase.com/blog/launch-week-6-community-day"data-href-disabled>Community Day</a></li>
<li><a data-original-href="https://supabase.com/blog/postgres-point-in-time-recovery"data-href-disabled>Point in Time Recovery is now available</a></li>
<li><a data-original-href="https://supabase.com/blog/custom-domain-names"data-href-disabled>Custom Domain Names are now available</a></li>
<li><a data-original-href="https://supabase.com/blog/launch-week-6-wrap-up"data-href-disabled>Wrap Up: everything we shipped</a></li>
</ul></div></article><div class="block lg:hidden py-8"><div class="text-foreground-lighter text-sm">Share this article</div><div class="mt-4 flex items-center gap-4"><a aria-label="Share on X" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;text=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" d="M12.6009 0.903908H15.0544L9.69434 7.03008L16 15.3664H11.0627L7.19566 10.3105L2.77087 15.3664H0.31595L6.04904 8.81379L0 0.903908H5.06262L8.55811 5.52524L12.6009 0.903908ZM11.7399 13.8979H13.0993L4.32392 2.29528H2.86506L11.7399 13.8979Z"></path></svg></div></a><a aria-label="Share on Linkedin" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;text=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" d="M0 1.85859C0 1.31985 0.180185 0.87541 0.540541 0.525253C0.900896 0.175079 1.36937 0 1.94595 0C2.51223 0 2.97039 0.17238 3.32046 0.517172C3.68082 0.872727 3.861 1.33602 3.861 1.90707C3.861 2.42424 3.68598 2.85521 3.33591 3.2C2.97555 3.55556 2.50193 3.73333 1.91506 3.73333H1.89961C1.33333 3.73333 0.875166 3.55556 0.525097 3.2C0.175027 2.84444 0 2.3973 0 1.85859ZM0.200772 16V5.20404H3.62934V16H0.200772ZM5.52896 16H8.95753V9.97172C8.95753 9.5946 8.99872 9.30369 9.08108 9.09899C9.22522 8.73265 9.44402 8.42289 9.73745 8.1697C10.0309 7.91649 10.399 7.7899 10.8417 7.7899C11.9949 7.7899 12.5714 8.60336 12.5714 10.2303V16H16V9.8101C16 8.21548 15.6396 7.00606 14.9189 6.18182C14.1982 5.35758 13.2458 4.94545 12.0618 4.94545C10.7336 4.94545 9.69884 5.54343 8.95753 6.73939V6.77172H8.94208L8.95753 6.73939V5.20404H5.52896C5.54954 5.54882 5.55985 6.62086 5.55985 8.4202C5.55985 10.2195 5.54954 12.7461 5.52896 16Z"></path></svg></div></a><a aria-label="Share on Hacker News" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;t=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M0 0H16V16H0V0ZM4.69024 3.8925L7.46363 9.0659V12.4258H8.53025V9.11913L11.3036 3.8925H10.1302L8.53025 7.14582C8.42355 7.30582 8.31694 7.46582 8.26363 7.62582C8.23286 7.74859 8.1845 7.83601 8.13883 7.91862C8.10515 7.97957 8.07286 8.0379 8.05024 8.10582C8.02355 8.07913 8.01017 8.03913 7.99686 7.99906C7.98355 7.95913 7.97024 7.91913 7.94355 7.89244C7.91686 7.83913 7.90348 7.79906 7.89017 7.75899C7.87686 7.71906 7.86355 7.67906 7.83694 7.62582V7.57251L7.78355 7.51913C7.76319 7.47841 7.75061 7.44546 7.73984 7.41731C7.72246 7.37171 7.70988 7.33877 7.67694 7.30582C7.62355 7.25251 7.57024 7.19913 7.57024 7.14582L5.97024 3.8925H4.69024Z"></path></svg></div></a></div></div><div class="grid gap-8 py-8 lg:grid-cols-1"><div><a data-original-href="/blog/new-supabase-docs-built-with-nextjs"data-href-disabled><div><div class="hover:bg-control cursor-pointer rounded border p-6 transition"><div class="space-y-4"><div><p class="text-foreground-lighter text-sm">Last post</p></div><div><h4 class="text-foreground text-lg">New Supabase Docs, built with Next.js</h4><p class="small">12 December 2022</p></div></div></div></div></a></div><div><a data-original-href="/blog/launch-week-6-hackathon"data-href-disabled><div class="text-right"><div class="hover:bg-control cursor-pointer rounded border p-6 transition"><div class="space-y-4"><div><p class="text-foreground-lighter text-sm">Next post</p></div><div><h4 class="text-foreground text-lg">Launch Week 6 Hackathon</h4><p class="small">9 December 2022</p></div></div></div></div></a></div></div></div><div class="relative col-span-12 space-y-8 lg:col-span-5 xl:col-span-3 xl:col-start-9"><div class="space-y-6"><div class="hidden lg:block"><div class="space-y-8 py-8 lg:py-0"><div><div class="flex flex-wrap gap-2"><a data-original-href="/blog/tags/launch-week"data-href-disabled><div class="inline-flex items-center rounded-full bg-opacity-10 bg-surface-200 text-foreground-light border border-strong px-2.5 py-0.5 text-xs">launch-week</div></a><a data-original-href="/blog/tags/postgres"data-href-disabled><div class="inline-flex items-center rounded-full bg-opacity-10 bg-surface-200 text-foreground-light border border-strong px-2.5 py-0.5 text-xs">postgres</div></a><a data-original-href="/blog/tags/planetpg"data-href-disabled><div class="inline-flex items-center rounded-full bg-opacity-10 bg-surface-200 text-foreground-light border border-strong px-2.5 py-0.5 text-xs">planetpg</div></a></div></div><div><div><p class="text-foreground mb-4">On this page</p><div class="prose-toc"><ul>
<li><a data-original-href="#whats-a-crdt"data-href-disabled>What&#x27;s a CRDT?</a></li>
<li><a data-original-href="#offline-philosophy"data-href-disabled>Offline philosophy</a></li>
<li><a data-original-href="#postgres-crdt-extension"data-href-disabled>Postgres CRDT extension</a></li>
<li><a data-original-href="#why-not-build-this-into-realtime"data-href-disabled>Why not build this into Realtime?</a></li>
<li><a data-original-href="#limitations"data-href-disabled>Limitations</a></li>
<li><a data-original-href="#next-steps"data-href-disabled>Next steps</a></li>
<li><a data-original-href="#more-launch-week-6"data-href-disabled>More Launch Week 6</a></li>
</ul></div></div></div></div></div><div class="hidden lg:block"><div class="text-foreground text-sm">Share this article</div><div class="mt-4 flex items-center gap-4"><a aria-label="Share on X" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;text=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" d="M12.6009 0.903908H15.0544L9.69434 7.03008L16 15.3664H11.0627L7.19566 10.3105L2.77087 15.3664H0.31595L6.04904 8.81379L0 0.903908H5.06262L8.55811 5.52524L12.6009 0.903908ZM11.7399 13.8979H13.0993L4.32392 2.29528H2.86506L11.7399 13.8979Z"></path></svg></div></a><a aria-label="Share on Linkedin" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;text=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" d="M0 1.85859C0 1.31985 0.180185 0.87541 0.540541 0.525253C0.900896 0.175079 1.36937 0 1.94595 0C2.51223 0 2.97039 0.17238 3.32046 0.517172C3.68082 0.872727 3.861 1.33602 3.861 1.90707C3.861 2.42424 3.68598 2.85521 3.33591 3.2C2.97555 3.55556 2.50193 3.73333 1.91506 3.73333H1.89961C1.33333 3.73333 0.875166 3.55556 0.525097 3.2C0.175027 2.84444 0 2.3973 0 1.85859ZM0.200772 16V5.20404H3.62934V16H0.200772ZM5.52896 16H8.95753V9.97172C8.95753 9.5946 8.99872 9.30369 9.08108 9.09899C9.22522 8.73265 9.44402 8.42289 9.73745 8.1697C10.0309 7.91649 10.399 7.7899 10.8417 7.7899C11.9949 7.7899 12.5714 8.60336 12.5714 10.2303V16H16V9.8101C16 8.21548 15.6396 7.00606 14.9189 6.18182C14.1982 5.35758 13.2458 4.94545 12.0618 4.94545C10.7336 4.94545 9.69884 5.54343 8.95753 6.73939V6.77172H8.94208L8.95753 6.73939V5.20404H5.52896C5.54954 5.54882 5.55985 6.62086 5.55985 8.4202C5.55985 10.2195 5.54954 12.7461 5.52896 16Z"></path></svg></div></a><a aria-label="Share on Hacker News" target="_blank" class="text-foreground-lighter hover:text-foreground" data-original-href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fsupabase.com%2Fblog%2Fpostgres-crdt&amp;t=pg_crdt%20-%20an%20experimental%20CRDT%20extension%20for%20Postgres"data-href-disabled><div class="relative" style="width:20px;height:20px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M0 0H16V16H0V0ZM4.69024 3.8925L7.46363 9.0659V12.4258H8.53025V9.11913L11.3036 3.8925H10.1302L8.53025 7.14582C8.42355 7.30582 8.31694 7.46582 8.26363 7.62582C8.23286 7.74859 8.1845 7.83601 8.13883 7.91862C8.10515 7.97957 8.07286 8.0379 8.05024 8.10582C8.02355 8.07913 8.01017 8.03913 7.99686 7.99906C7.98355 7.95913 7.97024 7.91913 7.94355 7.89244C7.91686 7.83913 7.90348 7.79906 7.89017 7.75899C7.87686 7.71906 7.86355 7.67906 7.83694 7.62582V7.57251L7.78355 7.51913C7.76319 7.47841 7.75061 7.44546 7.73984 7.41731C7.72246 7.37171 7.70988 7.33877 7.67694 7.30582C7.62355 7.25251 7.57024 7.19913 7.57024 7.14582L5.97024 3.8925H4.69024Z"></path></svg></div></a></div></div></div></div></div></div></div></div><div class="bg-background grid grid-cols-12 items-center gap-4 border-t py-32 text-center px-16"><div class="col-span-12"><h2 class="h2"><span class="text-foreground-lighter">Build in a weekend,</span><span class="text-foreground block sm:inline"> scale to millions</span></h2></div><div class="flex items-center justify-center gap-2 col-span-12 mt-4"><a data-size="medium" type="button" class="relative justify-center cursor-pointer inline-flex items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border bg-brand-400 dark:bg-brand-500 hover:bg-brand/80 dark:hover:bg-brand/50 text-foreground border-brand-500/75 dark:border-brand/30 hover:border-brand-600 dark:hover:border-brand focus-visible:outline-brand-600 data-[state=open]:bg-brand-400/80 dark:data-[state=open]:bg-brand-500/80 data-[state=open]:outline-brand-600 text-sm px-4 py-2 h-[38px]" data-original-href="https://supabase.com/dashboard"data-href-disabled><span class="truncate">Start your project</span></a><a data-size="medium" type="button" class="relative justify-center cursor-pointer inline-flex items-center space-x-2 text-center font-regular ease-out duration-200 rounded-md outline-none transition-all outline-0 focus-visible:outline-4 focus-visible:outline-offset-1 border text-foreground bg-alternative dark:bg-muted hover:bg-selection border-strong hover:border-stronger focus-visible:outline-brand-600 data-[state=open]:bg-selection data-[state=open]:outline-brand-600 data-[state=open]:border-button-hover text-sm px-4 py-2 h-[38px]" data-original-href="/contact/sales"data-href-disabled><span class="truncate">Request a demo</span></a></div></div></main><footer class="bg-alternative" aria-labelledby="footerHeading"><h2 id="footerHeading" class="sr-only">Footer</h2><div class="w-full !py-0"><div class="sm:py-18 container relative mx-auto px-6 py-16 md:py-24 lg:px-16 lg:py-24 xl:px-20 grid grid-cols-2 md:flex items-center justify-between text-foreground md:justify-center gap-8 md:gap-16 xl:gap-28 !py-6 md:!py-10 text-sm"><div class="flex flex-col md:flex-row gap-2 md:items-center">We protect your data.<a class="text-brand hover:underline" data-original-href="/security"data-href-disabled>More on Security</a></div><ul class="flex flex-col md:flex-row gap-2 md:gap-8 justify-center md:items-center"><li class="flex items-center gap-2 whitespace-nowrap flex-nowrap"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg> SOC2 Type 2<!-- --> <span class="text-foreground-lighter hidden sm:inline">Certified</span></li><li class="flex items-center gap-2 whitespace-nowrap flex-nowrap"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path></svg> HIPAA<!-- --> <span class="text-foreground-lighter hidden sm:inline">Compliant</span></li></ul></div><div class="w-full h-px bg-gradient-to-r from-transparent via-border to-transparent"></div></div><div class="sm:py-18 container relative mx-auto px-6 py-16 md:py-24 lg:px-16 lg:py-24 xl:px-20 py-8"><div class="xl:grid xl:grid-cols-3 xl:gap-8"><div class="space-y-8 xl:col-span-1"><a class="w-40" data-original-href="/"data-href-disabled><img alt="Supabase Logo" fetchpriority="high" width="160" height="30" decoding="async" data-nimg="1" class="dark:hidden" style="color:transparent" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0004%2Epng%26amp%3Bw%3D384%26amp%3Bq%3D75%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/><img alt="Supabase Logo" fetchpriority="high" width="160" height="30" decoding="async" data-nimg="1" class="hidden dark:block" style="color:transparent" src="asset://localhost/%2FUsers%2Fblackprince%2FUNMS%2FResearch%2Fitems%2F01JT3850CVAZYDGMGKN50RJNY9%2Fsupabase%5Fcom%5Fblog%5Fpostgres%2Dcrdt%2Fassets%2Fasset%5F0005%2Epng%26amp%3Bw%3D384%26amp%3Bq%3D75%26amp%3Bdpl%3Ddpl%5F4PTCgumi5w7tgv2j4qrU9SFC9HQ6"/></a><div class="flex space-x-5"><a data-original-href="https://twitter.com/supabase" class="text-foreground-lighter hover:text-foreground transition"data-href-disabled><span class="sr-only">Twitter</span><div class="relative" style="width:22px;height:22px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill="currentColor" d="M12.6009 0.903908H15.0544L9.69434 7.03008L16 15.3664H11.0627L7.19566 10.3105L2.77087 15.3664H0.31595L6.04904 8.81379L0 0.903908H5.06262L8.55811 5.52524L12.6009 0.903908ZM11.7399 13.8979H13.0993L4.32392 2.29528H2.86506L11.7399 13.8979Z"></path></svg></div></a><a data-original-href="https://github.com/supabase" class="text-foreground-lighter hover:text-foreground transition"data-href-disabled><span class="sr-only">GitHub</span><div class="relative" style="width:22px;height:22px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C3.5816 0 0 3.58719 0 8.01357C0 11.5535 2.292 14.5575 5.4712 15.6167C5.8712 15.6903 6.0168 15.4431 6.0168 15.2303C6.0168 15.0407 6.0104 14.5359 6.0064 13.8679C3.7808 14.3519 3.3112 12.7935 3.3112 12.7935C2.948 11.8671 2.4232 11.6207 2.4232 11.6207C1.6968 11.1247 2.4784 11.1343 2.4784 11.1343C3.2808 11.1903 3.7032 11.9599 3.7032 11.9599C4.4168 13.1839 5.576 12.8303 6.0312 12.6255C6.1048 12.1079 6.3112 11.7551 6.54 11.5551C4.764 11.3527 2.896 10.6647 2.896 7.59438C2.896 6.71998 3.208 6.00398 3.7192 5.44398C3.6368 5.24158 3.3624 4.42639 3.7976 3.32399C3.7976 3.32399 4.4696 3.10799 5.9976 4.14479C6.65022 3.9668 7.32355 3.87614 8 3.87519C8.68 3.87839 9.364 3.96719 10.0032 4.14479C11.5304 3.10799 12.2008 3.32319 12.2008 3.32319C12.6376 4.42639 12.3624 5.24158 12.2808 5.44398C12.7928 6.00398 13.1032 6.71998 13.1032 7.59438C13.1032 10.6727 11.232 11.3503 9.4504 11.5487C9.73762 11.7959 9.99282 12.2847 9.99282 13.0327C9.99282 14.1031 9.98322 14.9679 9.98322 15.2303C9.98322 15.4447 10.1272 15.6943 10.5336 15.6159C12.1266 15.0816 13.5115 14.0602 14.4924 12.696C15.4733 11.3318 16.0007 9.69382 16 8.01357C16 3.58719 12.4176 0 8 0Z" fill="currentColor"></path></svg></div></a><a data-original-href="https://discord.supabase.com/" class="text-foreground-lighter hover:text-foreground transition"data-href-disabled><span class="sr-only">Discord</span><div class="relative" style="width:22px;height:22px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.5447 3.01094C12.5249 2.54302 11.4313 2.19828 10.2879 2.00083C10.2671 1.99702 10.2463 2.00654 10.2356 2.02559C10.0949 2.27573 9.93921 2.60206 9.83011 2.85856C8.60028 2.67444 7.3768 2.67444 6.17222 2.85856C6.06311 2.59636 5.90166 2.27573 5.76038 2.02559C5.74966 2.00717 5.72887 1.99765 5.70803 2.00083C4.56527 2.19764 3.47171 2.54239 2.45129 3.01094C2.44246 3.01475 2.43488 3.0211 2.42986 3.02935C0.355594 6.12826 -0.212633 9.151 0.06612 12.1362C0.067381 12.1508 0.0755799 12.1648 0.0869319 12.1737C1.45547 13.1787 2.78114 13.7889 4.08219 14.1933C4.10301 14.1996 4.12507 14.192 4.13832 14.1749C4.44608 13.7546 4.72043 13.3114 4.95565 12.8454C4.96953 12.8181 4.95628 12.7857 4.92791 12.7749C4.49275 12.6099 4.0784 12.4086 3.67982 12.18C3.64829 12.1616 3.64577 12.1165 3.67477 12.095C3.75865 12.0321 3.84255 11.9667 3.92264 11.9007C3.93713 11.8886 3.95732 11.8861 3.97435 11.8937C6.59287 13.0892 9.42771 13.0892 12.0153 11.8937C12.0323 11.8854 12.0525 11.888 12.0677 11.9C12.1478 11.9661 12.2316 12.0321 12.3161 12.095C12.3451 12.1165 12.3433 12.1616 12.3117 12.18C11.9131 12.413 11.4988 12.6099 11.063 12.7743C11.0346 12.7851 11.022 12.8181 11.0359 12.8454C11.2762 13.3108 11.5505 13.7539 11.8526 14.1742C11.8652 14.192 11.8879 14.1996 11.9087 14.1933C13.2161 13.7889 14.5417 13.1787 15.9103 12.1737C15.9223 12.1648 15.9298 12.1515 15.9311 12.1369C16.2647 8.6856 15.3723 5.68765 13.5655 3.02998C13.5611 3.0211 13.5535 3.01475 13.5447 3.01094ZM5.34668 10.3185C4.55833 10.3185 3.90876 9.59478 3.90876 8.70593C3.90876 7.81707 4.54574 7.09331 5.34668 7.09331C6.15393 7.09331 6.79722 7.82342 6.7846 8.70593C6.7846 9.59478 6.14762 10.3185 5.34668 10.3185ZM10.6632 10.3185C9.87481 10.3185 9.22527 9.59478 9.22527 8.70593C9.22527 7.81707 9.86221 7.09331 10.6632 7.09331C11.4704 7.09331 12.1137 7.82342 12.1011 8.70593C12.1011 9.59478 11.4704 10.3185 10.6632 10.3185Z" fill="currentColor"></path></svg></div></a><a data-original-href="https://youtube.com/c/supabase" class="text-foreground-lighter hover:text-foreground transition"data-href-disabled><span class="sr-only">Youtube</span><div class="relative" style="width:22px;height:22px"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="none" stroke="none" class="sbui-icon" width="100%" height="100%"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.6657 4.13526C15.4817 3.44239 14.9395 2.8967 14.2511 2.71152C13.0033 2.37502 8 2.37502 8 2.37502C8 2.37502 2.99669 2.37502 1.74891 2.71152C1.06052 2.89673 0.518351 3.44239 0.334337 4.13526C1.90735e-06 5.39112 1.90735e-06 8.01137 1.90735e-06 8.01137C1.90735e-06 8.01137 1.90735e-06 10.6316 0.334337 11.8875C0.518351 12.5804 1.06052 13.1033 1.74891 13.2885C2.99669 13.625 8 13.625 8 13.625C8 13.625 13.0033 13.625 14.2511 13.2885C14.9395 13.1033 15.4817 12.5804 15.6657 11.8875C16 10.6316 16 8.01137 16 8.01137C16 8.01137 16 5.39112 15.6657 4.13526ZM6.36363 10.3904V5.63238L10.5454 8.01143L6.36363 10.3904Z" fill="currentColor"></path></svg></div></a></div></div><div class="mt-12 grid grid-cols-1 gap-8 xl:col-span-2 xl:mt-0"><div class="grid grid-cols-2 gap-8 md:grid-cols-4"><div><h6 class="text-foreground overwrite text-base">Product</h6><ul class="mt-4 space-y-2"><li><a data-original-href="/database"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Database</div></a></li><li><a data-original-href="/auth"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Auth</div></a></li><li><a data-original-href="/edge-functions"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Functions</div></a></li><li><a data-original-href="/realtime"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Realtime</div></a></li><li><a data-original-href="/storage"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Storage</div></a></li><li><a data-original-href="/modules/vector"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Vector</div></a></li><li><a data-original-href="/modules/cron"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Cron</div></a></li><li><a data-original-href="/pricing"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Pricing</div></a></li><li><a data-original-href="/launch-week"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Launch Week</div></a></li><li><a data-original-href="/solutions/ai-builders"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">AI Builders</div></a></li></ul></div><div><h6 class="text-foreground overwrite text-base">Resources</h6><ul class="mt-4 space-y-2"><li><a data-original-href="/support"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Support</div></a></li><li><a data-original-href="https://status.supabase.com/"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">System Status</div></a></li><li><a data-original-href="/partners"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Become a Partner</div></a></li><li><a data-original-href="/partners/integrations"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Integrations</div></a></li><li><a data-original-href="/brand-assets"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Brand Assets / Logos</div></a></li><li><a data-original-href="/security"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Security and Compliance</div></a></li><li><a data-original-href="/legal/dpa"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">DPA</div></a></li><li><a data-original-href="/security"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">SOC2</div></a></li><li><a data-original-href="https://forms.supabase.com/hipaa2"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">HIPAA</div></a></li></ul></div><div><h6 class="text-foreground overwrite text-base">Developers</h6><ul class="mt-4 space-y-2"><li><a data-original-href="/docs"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Documentation</div></a></li><li><a data-original-href="https://supabase.com/ui"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Supabase UI</div></a></li><li><a data-original-href="/changelog"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Changelog</div></a></li><li><a data-original-href="https://github.com/supabase/supabase/blob/master/CONTRIBUTING.md"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Contributing</div></a></li><li><a data-original-href="/open-source"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Open Source</div></a></li><li><a data-original-href="/supasquad"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">SupaSquad</div></a></li><li><a data-original-href="https://dev.to/supabase"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">DevTo</div></a></li><li><a data-original-href="/rss.xml"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">RSS</div></a></li></ul></div><div><h6 class="text-foreground overwrite text-base">Company</h6><ul class="mt-4 space-y-2"><li><a data-original-href="/blog"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Blog</div></a></li><li><a data-original-href="/customers"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Customer Stories</div></a></li><li><a data-original-href="/careers"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Careers</div></a></li><li><a data-original-href="/company"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Company</div></a></li><li><a data-original-href="/events"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Events &amp; Webinars</div></a></li><li><a data-original-href="/ga"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">General Availability</div></a></li><li><a data-original-href="/terms"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Terms of Service</div></a></li><li><a data-original-href="/privacy"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Privacy Policy</div></a></li><li><button><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Privacy Settings</div></button></li><li><a data-original-href="/aup"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Acceptable Use Policy</div></a></li><li><a data-original-href="/support-policy"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Support Policy</div></a></li><li><a data-original-href="/sla"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Service Level Agreement</div></a></li><li><a data-original-href="/humans.txt"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Humans.txt</div></a></li><li><a data-original-href="/lawyers.txt"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Lawyers.txt</div></a></li><li><a data-original-href="/.well-known/security.txt"data-href-disabled><div class="text-sm transition-colors text-foreground-lighter hover:text-foreground ">Security.txt</div></a></li></ul></div></div></div></div><div class="border-default mt-32 flex justify-between border-t pt-8"><small class="small">© Supabase Inc</small><div class=""></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"prevPost":{"slug":"new-supabase-docs-built-with-nextjs","title":"New Supabase Docs, built with Next.js","description":"We've redesigned our Docs and migrated to Next.js","author":"jonny","image":"lw6-day-1/lw6-day1-docs.jpg","thumb":"lw6-day-1/lw6-day1-docs.jpg","categories":["product"],"tags":["launch-week","docs"],"date":"2022-12-12","toc_depth":3,"video":"https://www.youtube.com/v/Q1Amk6iDlF8","youtubeHero":"https://www.youtube-nocookie.com/embed/Q1Amk6iDlF8","formattedDate":"12 December 2022","readingTime":"6 minute read","url":"/blog/new-supabase-docs-built-with-nextjs","path":"/blog/new-supabase-docs-built-with-nextjs"},"nextPost":{"slug":"launch-week-6-hackathon","title":"Launch Week 6 Hackathon","description":"Build an Open Source Project, Win $1500 and the Supabase Darkmode Keyboard","author":"ant_wilson","image":"lw6-hackathon/thumbnail.jpg","thumb":"lw6-hackathon/thumbnail.jpg","categories":["launch-week"],"tags":["launch-week","hackathon"],"date":"2022-12-09","toc_depth":3,"formattedDate":"9 December 2022","readingTime":"5 minute read","url":"/blog/launch-week-6-hackathon","path":"/blog/launch-week-6-hackathon"},"relatedPosts":[{"slug":"launch-week-14-top-10","title":"Top 10 Launches of Launch Week 14","description":"Highlights from Launch Week 14","author":"wenbo","image":"launch-week-14/wrap-up/og.png","thumb":"launch-week-14/wrap-up/thumb.png","launchweek":"14","categories":["launch-week"],"tags":["launch-week"],"date":"2025-04-04T00:00:02","toc_depth":3,"formattedDate":"4 April 2025","readingTime":"4 minute read","url":"/blog/launch-week-14-top-10","path":"/blog/launch-week-14-top-10"},{"slug":"mcp-server","title":"Supabase MCP Server","description":"Connect your AI tools to Supabase using MCP","author":"gregnr","image":"launch-week-14/day-5-mcp-server/og.png","thumb":"launch-week-14/day-5-mcp-server/thumb.png","categories":["launch-week"],"tags":["launch-week"],"date":"2025-04-04T00:00:01","toc_depth":3,"launchweek":14,"formattedDate":"4 April 2025","readingTime":"9 minute read","url":"/blog/mcp-server","path":"/blog/mcp-server"},{"slug":"data-api-nearest-read-replica","title":"Data API Routes to Nearest Read Replica","description":"Route your Data API (PostgREST) requests to the nearest Read Replica","author":"jose","image":"lw14-data-api-nearest-rr/og.png","thumb":"lw14-data-api-nearest-rr/thumb.png","categories":["launch-week","product"],"tags":["launch-week","postgrest"],"date":"2025-04-04T00:00:00","toc_depth":3,"launchweek":14,"formattedDate":"4 April 2025","readingTime":"3 minute read","url":"/blog/data-api-nearest-read-replica","path":"/blog/data-api-nearest-read-replica"},{"slug":"declarative-schemas","title":"Declarative Schemas for Simpler Database Management","description":"Simplify managing and maintaining complex database schemas","author":"qiao","image":"launch-week-14/day-4-declarative-schemas/og.png","thumb":"launch-week-14/day-4-declarative-schemas/thumb.png","categories":["launch-week","product"],"tags":["launch-week"],"date":"2025-04-03T00:00:00","toc_depth":3,"launchweek":14,"formattedDate":"3 April 2025","readingTime":"7 minute read","url":"/blog/declarative-schemas","path":"/blog/declarative-schemas"},{"slug":"realtime-broadcast-from-database","title":"Realtime: Broadcast from Database","description":"Use Realtime Broadcast to scale sending database changes to clients","author":"filipe","image":"launch-week-14/day-3-realtime-broadcast-from-database/og.png","thumb":"launch-week-14/day-3-realtime-broadcast-from-database/thumb.png","categories":["launch-week","product"],"tags":["launch-week","realtime"],"date":"2025-04-02T00:00:01","toc_depth":3,"launchweek":14,"formattedDate":"2 April 2025","readingTime":"6 minute read","url":"/blog/realtime-broadcast-from-database","path":"/blog/realtime-broadcast-from-database"}],"blog":{"slug":"postgres-crdt","source":"\nToday we're open-sourcing an EXPERIMENTAL extension for CRDTs, `pg_crdt`. The GitHub repo is [here](https://github.com/supabase/pg_crdt). There are [instructions](https://github.com/supabase/pg_crdt#installation) for running it locally in the README.\n\nWhen we released the new [multiplayer features](/blog/supabase-realtime-multiplayer-general-availability) for our Realtime engine,\nit took 30 minutes for someone to ask if we'd add CRDT support.\n\n\u003e _Anyone from Supabase here, do you have any plans to build in support for CRDT toolkits such as Yjs or AutoMerge for these features? It would make working with them so much easier if there was a plug and play backend._\n\n\u003csmall\u003e\n  \u003ci\u003e@samwillis on [HackerNews](https://news.ycombinator.com/item?id=32510820)\u003c/i\u003e\n\u003c/small\u003e\n\npg_crdt has not been released onto the Supabase platform (and it may never be). We're considering many options for offline-sync/support and, while CRDTs will undoubtedly factor in, we're not sure if this is the right approach. Hopefully this release generates a healthy discussion about the various ways we can do it at Supabase.\n\n## What's a CRDT?\n\nA CRDT (Conflict-free Replicated Data Type) is a data structure. More accurately, a family of data structures. They enable collaborative apps like [Figma](https://www.figma.com/blog/how-figmas-multiplayer-technology-works/).\n\nYou already know what a “data structure” is: an Array is a good example. CRDTs are a _special_ type of data structure designed to solve a specific problem: they can merge changes in a way that the final state of the data will be the same, no matter the order in which the updates were applied.\n\nIn simple terms, a CRDT allows multiple users to make changes to the same data without the need for a central authority to coordinate their actions.\n\nLet's use our Array example to demonstrate the problem they solve. Imagine you have an array (which is not a CRDT):\n\n```jsx\nlet fruit = ['Apple', 'Banana', 'Orange']\n```\n\nNow imagine you have 2 developers updating this array on their local computers. They both want to replace the fruit at the start of the array. The first user, let's call her “Jenny”, does this:\n\n```js\nfruit[0] = 'Grape' // the array is ['Grape', 'Banana', 'Orange']\n```\n\nThe developer sitting next to her, let's call him “Jonny”, does the same:\n\n```js\nfruit[0] = 'Mango' // the array is ['Mango', 'Banana', 'Orange']\n```\n\nAnd now, since they are both developing on different machines, they push their changes to a remote server. When the updates land on the remote system, what will `fruit[0]` be? “Grape” or “Mango”?\n\n![Array - which will be saved?](/images/blog/crdt/array.png)\n\nSince this is one of those _basic_ arrays, the answer is \"the fruit array that arrives last”.\n\n1. If Jonny's fruit array arrives first, it will be saved.\n2. After that, Jenny's fruit arrived and overwrites Jonny's changes.\n\nBut therein lies the problem: Jonny was the last developer to change his array of fruit, shouldn't his changes be the ones that are saved?\n\nThat's one of the things that CRDTs solve. There is an “array CRDT” which, when merged, will always have the same result. It doesn't matter if Jonny's array arrives first, or if Jenny's arrives first - every time you merge them they would be able to determine that the Jonny's was the last change the fruit array.\n\nHow does it do that? Some sort of algorithm, but you can ask ChatGPT to explain that one.\n\n## Offline philosophy\n\nCollaborative apps are becoming more prolific as legacy software is rebuilt within a browser environment.\n\nCollaboration is largely a data problem - how do we get one user's changes (data) to merge with another user's changes (data)? As a database provider it's natural fit for Supabase to provide the tooling for developers to build collaborative apps.\n\nBefore going too far down the “solution” rabbit hole at Supabase, we try to think about the long-term implications of adopting any technology. We're pretty boring - we don't make bets on technologies unless we think they will exist in 20 years.\n\nI personally believe CRDTs are the future. For _some things_. If databases were invented today, I'm certain most of the effort would be spent developing CRDT databases or something with “offline algorithms” built-in. But tech is a real-world demonstration of the Lindy effect: the longer something has existed, the longer it's likely to exist in the future. That's why we bet on Postgres - with more than 30 years history, it's here to stay.\n\nFaced with this reality, we should consider how to solve _offline with Postgres_ and where CRDTs might fit into that picture.\n\nFor a long time I thought there could be a way to shoehorn Postgres row-level data into a CRDT, to give _truly_ offline support. This may even still be [possible](https://electric-sql.com/), and it's one of the ideas we'll continue to pursue. But Postgres is a rich and evolving ecosystem, and I don't know whether it will be possible to -\n\na) find a merge strategy for an entire row, while simultaneously:\n\nb) finding a merge strategy for every data type _within_ that row (especially with the number of data types available through extensions)\n\nIt's possible that developers will need to be selective about their “level” of offline support, at least if they plan to use an “incumbent” databases. For the cases, a simple “last write wins” strategy is probably acceptable (see the excellent [Replicache](https://doc.replicache.dev/examples/repliear) and [Watermelon](https://nozbe.github.io/WatermelonDB/) libraries), but there will be important pieces of their application where it is not.\n\nTake this table of blog posts as an example:\n\n```sql\ncreate table posts (\n  id serial primary key,\n  title text,\n  content text default ''\n);\n```\n\nPerhaps it's not that important if the `title` has a “last write wins” strategy, because it's rarely updated and less likely to have a merge conflict. But it is critical to use a smarter algorithm for the `content` of the blog post, especially in a team where multiple users are editing a blog post at the same time.\n\nThat's a lot of background to get to what you probably want to know about:\n\n## Postgres CRDT extension\n\n`pg_crdt` is an extension which adds CRDT support to Postgres as a data type. For example, using our table from above:\n\n```sql\ncreate table posts (\n  id serial primary key,\n  title text,\n  content crdt.ydoc default crdt.new_ydoc()\n);\n```\n\nThe `content` column is now a [Yjs Doc](https://docs.yjs.dev/api/y.doc). Updates to this column are _commutative_ and _idempotent_. This means that they can be applied in any order and multiple times, and the result will always be the same. Two people can edit the blog content at the same time, and they won't have any issues when their changes are saved in the database.\n\n### Support for Yjs, Automerge, and beyond\n\nThe Yjs and Automerge teams have done some excellent work to create Rust libraries for their CRDTs implementations. It was relatively trivial to wrap the libraries into a Postgres extension using the [pgx](https://github.com/tcdi/pgx) framework.\n\nAt this stage it makes sense to give developers as many choices as possible in one extension. The CRDT space is nascent the algorithms are rapidly changing.\n\nImportantly, both Yjs and Automerge have _JavaScript_ and Rust implementations, which means they work natively in both a browser and a Postgres environment. Since collaborative applications are largely a client-side problem, CRDTs are more useful for developers if they have robust JavaScript libraries. In the future, if this extension becomes the approach we take, then Supabase will focus some resources on building Yjs/Automerge libraries for mobile devices too (Swift for iOS, Kotlin for Android).\n\n## Why not build this into Realtime?\n\nAn alternative approach for CRDT support in Supabase is to build support directly into [Realtime](https://github.com/supabase/realtime) and use it as an Authoritative server. In this scenario, Realtime would serialize the CRDT and save it to Postgres (probably as a `bytea` data type). Yjs has the concept of [Providers](https://github.com/yjs/yjs#providers) which would facilitate this. You can see the difference between the approaches in the diagram below - on the left, Realtime acts as the “middleman” for saving the CRDT in the database, whereas on the right the CRDT is pushed directly to the database, and Realtime receives updates from Postgres. (Note also that clients can send peer-to-peer updates.)\n\n![Realtime as an authority](/images/blog/crdt/authority.png)\n\nThis might still be our best option, but it should not be our first attempt. If we make Realtime the authority, it strongly couples developers to the Supabase infrastructure. By placing the CRDT into the database, it simplifies the architecture, enables other tools (like Debezium), and provides the possibility to update the database directly (for semi-realtime events like counters or page-views).\n\n![External providers](/images/blog/crdt/semi-realtime.png)\n\nThe Realtime engine seems like a great _compliment_ for `pg_crdt`, but before we put it into production we need to solve a few (major) limitations.\n\n## Limitations\n\nThese are a few of the _known_ limitations:\n\n- Realtime broadcasts database changes from the Postgres write ahead log (WAL). The WAL includes a complete copy of the the underlying data so small updates cause the entire document to broadcast to all collaborators\n- Frequently updated CRDTs produce a lot of WAL and dead tuples\n- Large CRDT types in Postgres generate significant serialization/deserialization overhead on-update.\n\nWe're likely to discover more (no doubt from a few friendly HN comments).\n\n## Next steps\n\nIf you want to help with `pg_crdt` the best way is to get involved in the GitHub repo. We have enabled [Discussions](https://github.com/supabase/pg_crdt/discussions) for any and all ideas. If you have experience with CRDTs and you like this approach, don't hesitate to contact one of the team.\n\n## More Launch Week 6\n\n- [Day 1: New Supabase Docs, built with Next.js](https://supabase.com/blog/new-supabase-docs-built-with-nextjs)\n- [Day 2: Supabase Storage v2: Image resizing and Smart CDN](https://supabase.com/blog/storage-image-resizing-smart-cdn)\n- [Day 3: Multi-factor Authentication via Row Level Security Enforcement](https://supabase.com/blog/mfa-auth-via-rls)\n- [Day 4: Supabase Wrappers, a Postgres FDW framework written in Rust](https://supabase.com/blog/postgres-foreign-data-wrappers-rust)\n- [Day 5: Supabase Vault is now in Beta](https://supabase.com/blog/vault-now-in-beta)\n- [Community Day](https://supabase.com/blog/launch-week-6-community-day)\n- [Point in Time Recovery is now available](https://supabase.com/blog/postgres-point-in-time-recovery)\n- [Custom Domain Names are now available](https://supabase.com/blog/custom-domain-names)\n- [Wrap Up: everything we shipped](https://supabase.com/blog/launch-week-6-wrap-up)\n","title":"pg_crdt - an experimental CRDT extension for Postgres","description":"Embedding Yjs and Automerge into Postgres for collaborative applications.","author":"paul_copplestone","image":"launch-week-6/crdt/og-pg-crdt.png","thumb":"launch-week-6/crdt/og-pg-crdt.png","categories":["postgres"],"tags":["launch-week","postgres","planetpg"],"date":"2022-12-10","toc_depth":2,"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    code: \"code\",\n    a: \"a\",\n    blockquote: \"blockquote\",\n    em: \"em\",\n    h2: \"h2\",\n    img: \"img\",\n    ol: \"ol\",\n    li: \"li\",\n    h3: \"h3\",\n    ul: \"ul\"\n  }, _provideComponents(), props.components), {CH} = _components;\n  if (!CH) _missingMdxReference(\"CH\", false);\n  if (!CH.Code) _missingMdxReference(\"CH.Code\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(\"style\", {\n      dangerouslySetInnerHTML: {\n        __html: \"[data-ch-theme=\\\"supabase\\\"] {  --ch-t-colorScheme: var(--ch-0);--ch-t-foreground: var(--ch-4);--ch-t-background: var(--ch-16);--ch-t-editor-background: var(--ch-16);--ch-t-editor-foreground: var(--ch-4);--ch-t-editor-rangeHighlightBackground: var(--ch-19);--ch-t-editor-infoForeground: var(--ch-18);--ch-t-editor-selectionBackground: var(--ch-17);--ch-t-tab-activeBackground: var(--ch-16);--ch-t-tab-activeForeground: var(--ch-4);--ch-t-tab-inactiveBackground: var(--ch-21);--ch-t-tab-inactiveForeground: var(--ch-15);--ch-t-tab-border: var(--ch-22);--ch-t-tab-activeBorder: var(--ch-16);--ch-t-editorGroupHeader-tabsBackground: var(--ch-21);--ch-t-editorLineNumber-foreground: var(--ch-20);--ch-t-input-foreground: var(--ch-4);--ch-t-sideBar-foreground: var(--ch-4);--ch-t-list-hoverBackground: var(--ch-25);--ch-t-list-hoverForeground: var(--ch-4); }\"\n      }\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Today we're open-sourcing an EXPERIMENTAL extension for CRDTs, \", _jsx(_components.code, {\n        children: \"pg_crdt\"\n      }), \". The GitHub repo is \", _jsx(_components.a, {\n        href: \"https://github.com/supabase/pg_crdt\",\n        children: \"here\"\n      }), \". There are \", _jsx(_components.a, {\n        href: \"https://github.com/supabase/pg_crdt#installation\",\n        children: \"instructions\"\n      }), \" for running it locally in the README.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"When we released the new \", _jsx(_components.a, {\n        href: \"/blog/supabase-realtime-multiplayer-general-availability\",\n        children: \"multiplayer features\"\n      }), \" for our Realtime engine,\\nit took 30 minutes for someone to ask if we'd add CRDT support.\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.em, {\n          children: \"Anyone from Supabase here, do you have any plans to build in support for CRDT toolkits such as Yjs or AutoMerge for these features? It would make working with them so much easier if there was a plug and play backend.\"\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(\"small\", {\n      children: _jsxs(\"i\", {\n        children: [\"@samwillis on \", _jsx(_components.a, {\n          href: \"https://news.ycombinator.com/item?id=32510820\",\n          children: \"HackerNews\"\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"pg_crdt has not been released onto the Supabase platform (and it may never be). We're considering many options for offline-sync/support and, while CRDTs will undoubtedly factor in, we're not sure if this is the right approach. Hopefully this release generates a healthy discussion about the various ways we can do it at Supabase.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"whats-a-crdt\",\n      children: \"What's a CRDT?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"A CRDT (Conflict-free Replicated Data Type) is a data structure. More accurately, a family of data structures. They enable collaborative apps like \", _jsx(_components.a, {\n        href: \"https://www.figma.com/blog/how-figmas-multiplayer-technology-works/\",\n        children: \"Figma\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"You already know what a “data structure” is: an Array is a good example. CRDTs are a \", _jsx(_components.em, {\n        children: \"special\"\n      }), \" type of data structure designed to solve a specific problem: they can merge changes in a way that the final state of the data will be the same, no matter the order in which the updates were applied.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In simple terms, a CRDT allows multiple users to make changes to the same data without the need for a central authority to coordinate their actions.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's use our Array example to demonstrate the problem they solve. Imagine you have an array (which is not a CRDT):\"\n    }), \"\\n\", _jsx(CH.Code, {\n      codeConfig: chCodeConfig,\n      northPanel: {\n        \"tabs\": [\"\"],\n        \"active\": \"\",\n        \"heightRatio\": 1\n      },\n      files: [{\n        \"name\": \"\",\n        \"focus\": \"\",\n        \"code\": {\n          \"lines\": [{\n            \"tokens\": [{\n              \"content\": \"let\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \" fruit \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"=\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \" [\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"'Apple'\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }, {\n              \"content\": \", \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"'Banana'\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }, {\n              \"content\": \", \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"'Orange'\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }, {\n              \"content\": \"]\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }],\n          \"lang\": \"jsx\"\n        },\n        \"annotations\": []\n      }]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now imagine you have 2 developers updating this array on their local computers. They both want to replace the fruit at the start of the array. The first user, let's call her “Jenny”, does this:\"\n    }), \"\\n\", _jsx(CH.Code, {\n      codeConfig: chCodeConfig,\n      northPanel: {\n        \"tabs\": [\"\"],\n        \"active\": \"\",\n        \"heightRatio\": 1\n      },\n      files: [{\n        \"name\": \"\",\n        \"focus\": \"\",\n        \"code\": {\n          \"lines\": [{\n            \"tokens\": [{\n              \"content\": \"fruit[\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"0\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \"] \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"= \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"'Grape' \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }, {\n              \"content\": \"// the array is ['Grape', 'Banana', 'Orange']\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-1)\"\n                }\n              }\n            }]\n          }],\n          \"lang\": \"js\"\n        },\n        \"annotations\": []\n      }]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The developer sitting next to her, let's call him “Jonny”, does the same:\"\n    }), \"\\n\", _jsx(CH.Code, {\n      codeConfig: chCodeConfig,\n      northPanel: {\n        \"tabs\": [\"\"],\n        \"active\": \"\",\n        \"heightRatio\": 1\n      },\n      files: [{\n        \"name\": \"\",\n        \"focus\": \"\",\n        \"code\": {\n          \"lines\": [{\n            \"tokens\": [{\n              \"content\": \"fruit[\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"0\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \"] \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"= \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"'Mango' \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }, {\n              \"content\": \"// the array is ['Mango', 'Banana', 'Orange']\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-1)\"\n                }\n              }\n            }]\n          }],\n          \"lang\": \"js\"\n        },\n        \"annotations\": []\n      }]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"And now, since they are both developing on different machines, they push their changes to a remote server. When the updates land on the remote system, what will \", _jsx(_components.code, {\n        children: \"fruit[0]\"\n      }), \" be? “Grape” or “Mango”?\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/images/blog/crdt/array.png\",\n        alt: \"Array - which will be saved?\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Since this is one of those \", _jsx(_components.em, {\n        children: \"basic\"\n      }), \" arrays, the answer is \\\"the fruit array that arrives last”.\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"If Jonny's fruit array arrives first, it will be saved.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"After that, Jenny's fruit arrived and overwrites Jonny's changes.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"But therein lies the problem: Jonny was the last developer to change his array of fruit, shouldn't his changes be the ones that are saved?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"That's one of the things that CRDTs solve. There is an “array CRDT” which, when merged, will always have the same result. It doesn't matter if Jonny's array arrives first, or if Jenny's arrives first - every time you merge them they would be able to determine that the Jonny's was the last change the fruit array.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"How does it do that? Some sort of algorithm, but you can ask ChatGPT to explain that one.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"offline-philosophy\",\n      children: \"Offline philosophy\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Collaborative apps are becoming more prolific as legacy software is rebuilt within a browser environment.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Collaboration is largely a data problem - how do we get one user's changes (data) to merge with another user's changes (data)? As a database provider it's natural fit for Supabase to provide the tooling for developers to build collaborative apps.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Before going too far down the “solution” rabbit hole at Supabase, we try to think about the long-term implications of adopting any technology. We're pretty boring - we don't make bets on technologies unless we think they will exist in 20 years.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I personally believe CRDTs are the future. For \", _jsx(_components.em, {\n        children: \"some things\"\n      }), \". If databases were invented today, I'm certain most of the effort would be spent developing CRDT databases or something with “offline algorithms” built-in. But tech is a real-world demonstration of the Lindy effect: the longer something has existed, the longer it's likely to exist in the future. That's why we bet on Postgres - with more than 30 years history, it's here to stay.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Faced with this reality, we should consider how to solve \", _jsx(_components.em, {\n        children: \"offline with Postgres\"\n      }), \" and where CRDTs might fit into that picture.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For a long time I thought there could be a way to shoehorn Postgres row-level data into a CRDT, to give \", _jsx(_components.em, {\n        children: \"truly\"\n      }), \" offline support. This may even still be \", _jsx(_components.a, {\n        href: \"https://electric-sql.com/\",\n        children: \"possible\"\n      }), \", and it's one of the ideas we'll continue to pursue. But Postgres is a rich and evolving ecosystem, and I don't know whether it will be possible to -\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"a) find a merge strategy for an entire row, while simultaneously:\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"b) finding a merge strategy for every data type \", _jsx(_components.em, {\n        children: \"within\"\n      }), \" that row (especially with the number of data types available through extensions)\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It's possible that developers will need to be selective about their “level” of offline support, at least if they plan to use an “incumbent” databases. For the cases, a simple “last write wins” strategy is probably acceptable (see the excellent \", _jsx(_components.a, {\n        href: \"https://doc.replicache.dev/examples/repliear\",\n        children: \"Replicache\"\n      }), \" and \", _jsx(_components.a, {\n        href: \"https://nozbe.github.io/WatermelonDB/\",\n        children: \"Watermelon\"\n      }), \" libraries), but there will be important pieces of their application where it is not.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Take this table of blog posts as an example:\"\n    }), \"\\n\", _jsx(CH.Code, {\n      codeConfig: chCodeConfig,\n      northPanel: {\n        \"tabs\": [\"\"],\n        \"active\": \"\",\n        \"heightRatio\": 1\n      },\n      files: [{\n        \"name\": \"\",\n        \"focus\": \"\",\n        \"code\": {\n          \"lines\": [{\n            \"tokens\": [{\n              \"content\": \"create table \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"posts\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-5)\"\n                }\n              }\n            }, {\n              \"content\": \" (\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  id \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"serial primary key\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \",\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  title \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"text\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \",\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  content \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"text default \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"''\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-8)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \");\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }],\n          \"lang\": \"sql\"\n        },\n        \"annotations\": []\n      }]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Perhaps it's not that important if the \", _jsx(_components.code, {\n        children: \"title\"\n      }), \" has a “last write wins” strategy, because it's rarely updated and less likely to have a merge conflict. But it is critical to use a smarter algorithm for the \", _jsx(_components.code, {\n        children: \"content\"\n      }), \" of the blog post, especially in a team where multiple users are editing a blog post at the same time.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"That's a lot of background to get to what you probably want to know about:\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"postgres-crdt-extension\",\n      children: \"Postgres CRDT extension\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.code, {\n        children: \"pg_crdt\"\n      }), \" is an extension which adds CRDT support to Postgres as a data type. For example, using our table from above:\"]\n    }), \"\\n\", _jsx(CH.Code, {\n      codeConfig: chCodeConfig,\n      northPanel: {\n        \"tabs\": [\"\"],\n        \"active\": \"\",\n        \"heightRatio\": 1\n      },\n      files: [{\n        \"name\": \"\",\n        \"focus\": \"\",\n        \"code\": {\n          \"lines\": [{\n            \"tokens\": [{\n              \"content\": \"create table \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"posts\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-5)\"\n                }\n              }\n            }, {\n              \"content\": \" (\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  id \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"serial primary key\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \",\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  title \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"text\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \",\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \"  content \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"crdt\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \".\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"ydoc \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \"default \",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-7)\"\n                }\n              }\n            }, {\n              \"content\": \"crdt\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \".\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }, {\n              \"content\": \"new_ydoc\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-2)\"\n                }\n              }\n            }, {\n              \"content\": \"()\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }, {\n            \"tokens\": [{\n              \"content\": \");\",\n              \"props\": {\n                \"style\": {\n                  \"color\": \"var(--ch-4)\"\n                }\n              }\n            }]\n          }],\n          \"lang\": \"sql\"\n        },\n        \"annotations\": []\n      }]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"content\"\n      }), \" column is now a \", _jsx(_components.a, {\n        href: \"https://docs.yjs.dev/api/y.doc\",\n        children: \"Yjs Doc\"\n      }), \". Updates to this column are \", _jsx(_components.em, {\n        children: \"commutative\"\n      }), \" and \", _jsx(_components.em, {\n        children: \"idempotent\"\n      }), \". This means that they can be applied in any order and multiple times, and the result will always be the same. Two people can edit the blog content at the same time, and they won't have any issues when their changes are saved in the database.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"support-for-yjs-automerge-and-beyond\",\n      children: \"Support for Yjs, Automerge, and beyond\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Yjs and Automerge teams have done some excellent work to create Rust libraries for their CRDTs implementations. It was relatively trivial to wrap the libraries into a Postgres extension using the \", _jsx(_components.a, {\n        href: \"https://github.com/tcdi/pgx\",\n        children: \"pgx\"\n      }), \" framework.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At this stage it makes sense to give developers as many choices as possible in one extension. The CRDT space is nascent the algorithms are rapidly changing.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Importantly, both Yjs and Automerge have \", _jsx(_components.em, {\n        children: \"JavaScript\"\n      }), \" and Rust implementations, which means they work natively in both a browser and a Postgres environment. Since collaborative applications are largely a client-side problem, CRDTs are more useful for developers if they have robust JavaScript libraries. In the future, if this extension becomes the approach we take, then Supabase will focus some resources on building Yjs/Automerge libraries for mobile devices too (Swift for iOS, Kotlin for Android).\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"why-not-build-this-into-realtime\",\n      children: \"Why not build this into Realtime?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"An alternative approach for CRDT support in Supabase is to build support directly into \", _jsx(_components.a, {\n        href: \"https://github.com/supabase/realtime\",\n        children: \"Realtime\"\n      }), \" and use it as an Authoritative server. In this scenario, Realtime would serialize the CRDT and save it to Postgres (probably as a \", _jsx(_components.code, {\n        children: \"bytea\"\n      }), \" data type). Yjs has the concept of \", _jsx(_components.a, {\n        href: \"https://github.com/yjs/yjs#providers\",\n        children: \"Providers\"\n      }), \" which would facilitate this. You can see the difference between the approaches in the diagram below - on the left, Realtime acts as the “middleman” for saving the CRDT in the database, whereas on the right the CRDT is pushed directly to the database, and Realtime receives updates from Postgres. (Note also that clients can send peer-to-peer updates.)\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/images/blog/crdt/authority.png\",\n        alt: \"Realtime as an authority\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This might still be our best option, but it should not be our first attempt. If we make Realtime the authority, it strongly couples developers to the Supabase infrastructure. By placing the CRDT into the database, it simplifies the architecture, enables other tools (like Debezium), and provides the possibility to update the database directly (for semi-realtime events like counters or page-views).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/images/blog/crdt/semi-realtime.png\",\n        alt: \"External providers\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Realtime engine seems like a great \", _jsx(_components.em, {\n        children: \"compliment\"\n      }), \" for \", _jsx(_components.code, {\n        children: \"pg_crdt\"\n      }), \", but before we put it into production we need to solve a few (major) limitations.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"limitations\",\n      children: \"Limitations\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"These are a few of the \", _jsx(_components.em, {\n        children: \"known\"\n      }), \" limitations:\"]\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Realtime broadcasts database changes from the Postgres write ahead log (WAL). The WAL includes a complete copy of the the underlying data so small updates cause the entire document to broadcast to all collaborators\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Frequently updated CRDTs produce a lot of WAL and dead tuples\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Large CRDT types in Postgres generate significant serialization/deserialization overhead on-update.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We're likely to discover more (no doubt from a few friendly HN comments).\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"next-steps\",\n      children: \"Next steps\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If you want to help with \", _jsx(_components.code, {\n        children: \"pg_crdt\"\n      }), \" the best way is to get involved in the GitHub repo. We have enabled \", _jsx(_components.a, {\n        href: \"https://github.com/supabase/pg_crdt/discussions\",\n        children: \"Discussions\"\n      }), \" for any and all ideas. If you have experience with CRDTs and you like this approach, don't hesitate to contact one of the team.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"more-launch-week-6\",\n      children: \"More Launch Week 6\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/new-supabase-docs-built-with-nextjs\",\n          children: \"Day 1: New Supabase Docs, built with Next.js\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/storage-image-resizing-smart-cdn\",\n          children: \"Day 2: Supabase Storage v2: Image resizing and Smart CDN\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/mfa-auth-via-rls\",\n          children: \"Day 3: Multi-factor Authentication via Row Level Security Enforcement\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/postgres-foreign-data-wrappers-rust\",\n          children: \"Day 4: Supabase Wrappers, a Postgres FDW framework written in Rust\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/vault-now-in-beta\",\n          children: \"Day 5: Supabase Vault is now in Beta\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/launch-week-6-community-day\",\n          children: \"Community Day\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/postgres-point-in-time-recovery\",\n          children: \"Point in Time Recovery is now available\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/custom-domain-names\",\n          children: \"Custom Domain Names are now available\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://supabase.com/blog/launch-week-6-wrap-up\",\n          children: \"Wrap Up: everything we shipped\"\n        })\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"chCodeConfig":{"theme":{"name":"supabase","type":"from-css","tokenColors":[{"scope":["comment","punctuation.definition.comment","string.comment"],"settings":{"foreground":"var(--ch-1)"}},{"scope":["constant","entity.name.constant","variable.other.constant","variable.other.enummember","variable.language","entity"],"settings":{"foreground":"var(--ch-2)"}},{"scope":["entity.name","meta.export.default","meta.definition.variable"],"settings":{"foreground":"var(--ch-3)"}},{"scope":["variable.parameter.function","meta.jsx.children","meta.block","meta.tag.attributes","entity.name.constant","meta.object.member","meta.embedded.expression"],"settings":{"foreground":"var(--ch-4)"}},{"scope":"entity.name.function","settings":{"foreground":"var(--ch-5)"}},{"scope":["entity.name.tag","support.class.component"],"settings":{"foreground":"var(--ch-6)"}},{"scope":"keyword","settings":{"foreground":"var(--ch-7)"}},{"scope":["storage","storage.type"],"settings":{"foreground":"var(--ch-7)"}},{"scope":["storage.modifier.package","storage.modifier.import","storage.type.java"],"settings":{"foreground":"var(--ch-4)"}},{"scope":["string","string punctuation.section.embedded source"],"settings":{"foreground":"var(--ch-8)"}},{"scope":"support","settings":{"foreground":"var(--ch-2)"}},{"scope":"meta.property-name","settings":{"foreground":"var(--ch-2)"}},{"scope":"variable","settings":{"foreground":"var(--ch-3)"}},{"scope":"variable.other","settings":{"foreground":"var(--ch-4)"}},{"scope":"invalid.broken","settings":{"foreground":"var(--ch-9)","fontStyle":"italic"}},{"scope":"invalid.deprecated","settings":{"foreground":"var(--ch-9)","fontStyle":"italic"}},{"scope":"invalid.illegal","settings":{"foreground":"var(--ch-9)","fontStyle":"italic"}},{"scope":"invalid.unimplemented","settings":{"foreground":"var(--ch-9)","fontStyle":"italic"}},{"scope":"carriage-return","settings":{"background":"var(--ch-7)","foreground":"var(--ch-10)","fontStyle":"italic underline"}},{"scope":"message.error","settings":{"foreground":"var(--ch-9)"}},{"scope":"string variable","settings":{"foreground":"var(--ch-2)"}},{"scope":["source.regexp","string.regexp"],"settings":{"foreground":"var(--ch-8)"}},{"scope":["string.regexp.character-class","string.regexp constant.character.escape","string.regexp source.ruby.embedded","string.regexp string.regexp.arbitrary-repitition"],"settings":{"foreground":"var(--ch-8)"}},{"scope":"string.regexp constant.character.escape","settings":{"foreground":"var(--ch-6)","fontStyle":"bold"}},{"scope":"support.constant","settings":{"foreground":"var(--ch-2)"}},{"scope":"support.variable","settings":{"foreground":"var(--ch-2)"}},{"scope":"support.type.property-name.json","settings":{"foreground":"var(--ch-6)"}},{"scope":"meta.module-reference","settings":{"foreground":"var(--ch-2)"}},{"scope":"punctuation.definition.list.begin.markdown","settings":{"foreground":"var(--ch-3)"}},{"scope":["markup.heading","markup.heading entity.name"],"settings":{"foreground":"var(--ch-2)","fontStyle":"bold"}},{"scope":"markup.quote","settings":{"foreground":"var(--ch-6)"}},{"scope":"markup.italic","settings":{"foreground":"var(--ch-4)","fontStyle":"italic"}},{"scope":"markup.bold","settings":{"foreground":"var(--ch-4)","fontStyle":"bold"}},{"scope":["markup.underline"],"settings":{"fontStyle":"underline"}},{"scope":["markup.strikethrough"],"settings":{"fontStyle":"strikethrough"}},{"scope":"markup.inline.raw","settings":{"foreground":"var(--ch-2)"}},{"scope":["markup.deleted","meta.diff.header.from-file","punctuation.definition.deleted"],"settings":{"background":"var(--ch-11)","foreground":"var(--ch-9)"}},{"scope":["punctuation.section.embedded"],"settings":{"foreground":"var(--ch-7)"}},{"scope":["markup.inserted","meta.diff.header.to-file","punctuation.definition.inserted"],"settings":{"background":"var(--ch-12)","foreground":"var(--ch-6)"}},{"scope":["markup.changed","punctuation.definition.changed"],"settings":{"background":"var(--ch-13)","foreground":"var(--ch-3)"}},{"scope":["markup.ignored","markup.untracked"],"settings":{"background":"var(--ch-2)","foreground":"var(--ch-14)"}},{"scope":"meta.diff.range","settings":{"foreground":"var(--ch-5)","fontStyle":"bold"}},{"scope":"meta.diff.header","settings":{"foreground":"var(--ch-2)"}},{"scope":"meta.separator","settings":{"foreground":"var(--ch-2)","fontStyle":"bold"}},{"scope":"meta.output","settings":{"foreground":"var(--ch-2)"}},{"scope":["brackethighlighter.tag","brackethighlighter.curly","brackethighlighter.round","brackethighlighter.square","brackethighlighter.angle","brackethighlighter.quote"],"settings":{"foreground":"var(--ch-15)"}},{"scope":"brackethighlighter.unmatched","settings":{"foreground":"var(--ch-9)"}},{"scope":["constant.other.reference.link","string.other.link"],"settings":{"foreground":"var(--ch-8)","fontStyle":"underline"}}],"colors":{"editor.background":"var(--ch-16)","editor.foreground":"var(--ch-4)","editor.selectionBackground":"var(--ch-17)","editor.infoForeground":"var(--ch-18)","editor.rangeHighlightBackground":"var(--ch-19)","editorLineNumber.foreground":"var(--ch-20)","tab.activeBackground":"var(--ch-16)","tab.inactiveBackground":"var(--ch-21)","tab.activeForeground":"var(--ch-4)","tab.inactiveForeground":"var(--ch-15)","tab.border":"var(--ch-22)","tab.activeBorder":"var(--ch-16)","tab.activeBorderTop":"var(--ch-23)","tab.hoverBackground":"var(--ch-16)","tab.hoverForeground":"var(--ch-15)","editorGroupHeader.tabsBorder":"var(--ch-22)","editorGroupHeader.tabsBackground":"var(--ch-21)","list.inactiveSelectionBackground":"var(--ch-24)","list.inactiveSelectionForeground":"var(--ch-4)","list.hoverBackground":"var(--ch-25)","list.hoverForeground":"var(--ch-4)"}},"lineNumbers":true,"showCopyButton":true,"skipLanguages":[],"autoImport":false}}},"toc":{"json":[{"content":"What's a CRDT?","slug":"whats-a-crdt","lvl":2,"i":0,"seen":0},{"content":"Offline philosophy","slug":"offline-philosophy","lvl":2,"i":1,"seen":0},{"content":"Postgres CRDT extension","slug":"postgres-crdt-extension","lvl":2,"i":2,"seen":0},{"content":"Support for Yjs, Automerge, and beyond","slug":"support-for-yjs-automerge-and-beyond","lvl":3,"i":3,"seen":0},{"content":"Why not build this into Realtime?","slug":"why-not-build-this-into-realtime","lvl":2,"i":4,"seen":0},{"content":"Limitations","slug":"limitations","lvl":2,"i":5,"seen":0},{"content":"Next steps","slug":"next-steps","lvl":2,"i":6,"seen":0},{"content":"More Launch Week 6","slug":"more-launch-week-6","lvl":2,"i":7,"seen":0}],"highest":2,"tokens":[{"type":"paragraph_open","tight":false,"lines":[1,2],"level":0},{"type":"inline","content":"Today we're open-sourcing an EXPERIMENTAL extension for CRDTs, `pg_crdt`. The GitHub repo is [here](https://github.com/supabase/pg_crdt). There are [instructions](https://github.com/supabase/pg_crdt#installation) for running it locally in the README.","level":1,"lines":[1,2],"children":[{"type":"text","content":"Today we're open-sourcing an EXPERIMENTAL extension for CRDTs, ","level":0},{"type":"code","content":"pg_crdt","block":false,"level":0},{"type":"text","content":". The GitHub repo is ","level":0},{"type":"link_open","href":"https://github.com/supabase/pg_crdt","title":"","level":0},{"type":"text","content":"here","level":1},{"type":"link_close","level":0},{"type":"text","content":". There are ","level":0},{"type":"link_open","href":"https://github.com/supabase/pg_crdt#installation","title":"","level":0},{"type":"text","content":"instructions","level":1},{"type":"link_close","level":0},{"type":"text","content":" for running it locally in the README.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[3,5],"level":0},{"type":"inline","content":"When we released the new [multiplayer features](/blog/supabase-realtime-multiplayer-general-availability) for our Realtime engine,\nit took 30 minutes for someone to ask if we'd add CRDT support.","level":1,"lines":[3,5],"children":[{"type":"text","content":"When we released the new ","level":0},{"type":"link_open","href":"/blog/supabase-realtime-multiplayer-general-availability","title":"","level":0},{"type":"text","content":"multiplayer features","level":1},{"type":"link_close","level":0},{"type":"text","content":" for our Realtime engine,","level":0},{"type":"softbreak","level":0},{"type":"text","content":"it took 30 minutes for someone to ask if we'd add CRDT support.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"blockquote_open","lines":[6,7],"level":0},{"type":"paragraph_open","tight":false,"lines":[6,7],"level":1},{"type":"inline","content":"_Anyone from Supabase here, do you have any plans to build in support for CRDT toolkits such as Yjs or AutoMerge for these features? It would make working with them so much easier if there was a plug and play backend._","level":2,"lines":[6,7],"children":[{"type":"em_open","level":0},{"type":"text","content":"Anyone from Supabase here, do you have any plans to build in support for CRDT toolkits such as Yjs or AutoMerge for these features? It would make working with them so much easier if there was a plug and play backend.","level":1},{"type":"em_close","level":0}]},{"type":"paragraph_close","tight":false,"level":1},{"type":"blockquote_close","level":0},{"type":"paragraph_open","tight":false,"lines":[8,11],"level":0},{"type":"inline","content":"\u003csmall\u003e\n  \u003ci\u003e@samwillis on [HackerNews](https://news.ycombinator.com/item?id=32510820)\u003c/i\u003e\n\u003c/small\u003e","level":1,"lines":[8,11],"children":[{"type":"text","content":"\u003csmall\u003e","level":0},{"type":"softbreak","level":0},{"type":"text","content":"\u003ci\u003e@samwillis on ","level":0},{"type":"link_open","href":"https://news.ycombinator.com/item?id=32510820","title":"","level":0},{"type":"text","content":"HackerNews","level":1},{"type":"link_close","level":0},{"type":"text","content":"\u003c/i\u003e","level":0},{"type":"softbreak","level":0},{"type":"text","content":"\u003c/small\u003e","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[12,13],"level":0},{"type":"inline","content":"pg_crdt has not been released onto the Supabase platform (and it may never be). We're considering many options for offline-sync/support and, while CRDTs will undoubtedly factor in, we're not sure if this is the right approach. Hopefully this release generates a healthy discussion about the various ways we can do it at Supabase.","level":1,"lines":[12,13],"children":[{"type":"text","content":"pg_crdt has not been released onto the Supabase platform (and it may never be). We're considering many options for offline-sync/support and, while CRDTs will undoubtedly factor in, we're not sure if this is the right approach. Hopefully this release generates a healthy discussion about the various ways we can do it at Supabase.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[14,15],"level":0},{"type":"inline","content":"[What's a CRDT?](#whats-a-crdt)","level":1,"lines":[14,15],"children":[{"type":"text","content":"What's a CRDT?","level":0}],"lvl":2,"i":0,"seen":0,"slug":"whats-a-crdt"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[16,17],"level":0},{"type":"inline","content":"A CRDT (Conflict-free Replicated Data Type) is a data structure. More accurately, a family of data structures. They enable collaborative apps like [Figma](https://www.figma.com/blog/how-figmas-multiplayer-technology-works/).","level":1,"lines":[16,17],"children":[{"type":"text","content":"A CRDT (Conflict-free Replicated Data Type) is a data structure. More accurately, a family of data structures. They enable collaborative apps like ","level":0},{"type":"link_open","href":"https://www.figma.com/blog/how-figmas-multiplayer-technology-works/","title":"","level":0},{"type":"text","content":"Figma","level":1},{"type":"link_close","level":0},{"type":"text","content":".","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[18,19],"level":0},{"type":"inline","content":"You already know what a “data structure” is: an Array is a good example. CRDTs are a _special_ type of data structure designed to solve a specific problem: they can merge changes in a way that the final state of the data will be the same, no matter the order in which the updates were applied.","level":1,"lines":[18,19],"children":[{"type":"text","content":"You already know what a “data structure” is: an Array is a good example. CRDTs are a ","level":0},{"type":"em_open","level":0},{"type":"text","content":"special","level":1},{"type":"em_close","level":0},{"type":"text","content":" type of data structure designed to solve a specific problem: they can merge changes in a way that the final state of the data will be the same, no matter the order in which the updates were applied.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[20,21],"level":0},{"type":"inline","content":"In simple terms, a CRDT allows multiple users to make changes to the same data without the need for a central authority to coordinate their actions.","level":1,"lines":[20,21],"children":[{"type":"text","content":"In simple terms, a CRDT allows multiple users to make changes to the same data without the need for a central authority to coordinate their actions.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[22,23],"level":0},{"type":"inline","content":"Let's use our Array example to demonstrate the problem they solve. Imagine you have an array (which is not a CRDT):","level":1,"lines":[22,23],"children":[{"type":"text","content":"Let's use our Array example to demonstrate the problem they solve. Imagine you have an array (which is not a CRDT):","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"fence","params":"jsx","content":"let fruit = ['Apple', 'Banana', 'Orange']\n","lines":[24,27],"level":0},{"type":"paragraph_open","tight":false,"lines":[28,29],"level":0},{"type":"inline","content":"Now imagine you have 2 developers updating this array on their local computers. They both want to replace the fruit at the start of the array. The first user, let's call her “Jenny”, does this:","level":1,"lines":[28,29],"children":[{"type":"text","content":"Now imagine you have 2 developers updating this array on their local computers. They both want to replace the fruit at the start of the array. The first user, let's call her “Jenny”, does this:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"fence","params":"js","content":"fruit[0] = 'Grape' // the array is ['Grape', 'Banana', 'Orange']\n","lines":[30,33],"level":0},{"type":"paragraph_open","tight":false,"lines":[34,35],"level":0},{"type":"inline","content":"The developer sitting next to her, let's call him “Jonny”, does the same:","level":1,"lines":[34,35],"children":[{"type":"text","content":"The developer sitting next to her, let's call him “Jonny”, does the same:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"fence","params":"js","content":"fruit[0] = 'Mango' // the array is ['Mango', 'Banana', 'Orange']\n","lines":[36,39],"level":0},{"type":"paragraph_open","tight":false,"lines":[40,41],"level":0},{"type":"inline","content":"And now, since they are both developing on different machines, they push their changes to a remote server. When the updates land on the remote system, what will `fruit[0]` be? “Grape” or “Mango”?","level":1,"lines":[40,41],"children":[{"type":"text","content":"And now, since they are both developing on different machines, they push their changes to a remote server. When the updates land on the remote system, what will ","level":0},{"type":"code","content":"fruit[0]","block":false,"level":0},{"type":"text","content":" be? “Grape” or “Mango”?","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[42,43],"level":0},{"type":"inline","content":"![Array - which will be saved?](/images/blog/crdt/array.png)","level":1,"lines":[42,43],"children":[{"type":"image","src":"/images/blog/crdt/array.png","title":"","alt":"Array - which will be saved?","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[44,45],"level":0},{"type":"inline","content":"Since this is one of those _basic_ arrays, the answer is \"the fruit array that arrives last”.","level":1,"lines":[44,45],"children":[{"type":"text","content":"Since this is one of those ","level":0},{"type":"em_open","level":0},{"type":"text","content":"basic","level":1},{"type":"em_close","level":0},{"type":"text","content":" arrays, the answer is \"the fruit array that arrives last”.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"ordered_list_open","order":1,"lines":[46,49],"level":0},{"type":"list_item_open","lines":[46,47],"level":1},{"type":"paragraph_open","tight":true,"lines":[46,47],"level":2},{"type":"inline","content":"If Jonny's fruit array arrives first, it will be saved.","level":3,"lines":[46,47],"children":[{"type":"text","content":"If Jonny's fruit array arrives first, it will be saved.","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[47,49],"level":1},{"type":"paragraph_open","tight":true,"lines":[47,48],"level":2},{"type":"inline","content":"After that, Jenny's fruit arrived and overwrites Jonny's changes.","level":3,"lines":[47,48],"children":[{"type":"text","content":"After that, Jenny's fruit arrived and overwrites Jonny's changes.","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"ordered_list_close","level":0},{"type":"paragraph_open","tight":false,"lines":[49,50],"level":0},{"type":"inline","content":"But therein lies the problem: Jonny was the last developer to change his array of fruit, shouldn't his changes be the ones that are saved?","level":1,"lines":[49,50],"children":[{"type":"text","content":"But therein lies the problem: Jonny was the last developer to change his array of fruit, shouldn't his changes be the ones that are saved?","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[51,52],"level":0},{"type":"inline","content":"That's one of the things that CRDTs solve. There is an “array CRDT” which, when merged, will always have the same result. It doesn't matter if Jonny's array arrives first, or if Jenny's arrives first - every time you merge them they would be able to determine that the Jonny's was the last change the fruit array.","level":1,"lines":[51,52],"children":[{"type":"text","content":"That's one of the things that CRDTs solve. There is an “array CRDT” which, when merged, will always have the same result. It doesn't matter if Jonny's array arrives first, or if Jenny's arrives first - every time you merge them they would be able to determine that the Jonny's was the last change the fruit array.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[53,54],"level":0},{"type":"inline","content":"How does it do that? Some sort of algorithm, but you can ask ChatGPT to explain that one.","level":1,"lines":[53,54],"children":[{"type":"text","content":"How does it do that? Some sort of algorithm, but you can ask ChatGPT to explain that one.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[55,56],"level":0},{"type":"inline","content":"[Offline philosophy](#offline-philosophy)","level":1,"lines":[55,56],"children":[{"type":"text","content":"Offline philosophy","level":0}],"lvl":2,"i":1,"seen":0,"slug":"offline-philosophy"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[57,58],"level":0},{"type":"inline","content":"Collaborative apps are becoming more prolific as legacy software is rebuilt within a browser environment.","level":1,"lines":[57,58],"children":[{"type":"text","content":"Collaborative apps are becoming more prolific as legacy software is rebuilt within a browser environment.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[59,60],"level":0},{"type":"inline","content":"Collaboration is largely a data problem - how do we get one user's changes (data) to merge with another user's changes (data)? As a database provider it's natural fit for Supabase to provide the tooling for developers to build collaborative apps.","level":1,"lines":[59,60],"children":[{"type":"text","content":"Collaboration is largely a data problem - how do we get one user's changes (data) to merge with another user's changes (data)? As a database provider it's natural fit for Supabase to provide the tooling for developers to build collaborative apps.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[61,62],"level":0},{"type":"inline","content":"Before going too far down the “solution” rabbit hole at Supabase, we try to think about the long-term implications of adopting any technology. We're pretty boring - we don't make bets on technologies unless we think they will exist in 20 years.","level":1,"lines":[61,62],"children":[{"type":"text","content":"Before going too far down the “solution” rabbit hole at Supabase, we try to think about the long-term implications of adopting any technology. We're pretty boring - we don't make bets on technologies unless we think they will exist in 20 years.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[63,64],"level":0},{"type":"inline","content":"I personally believe CRDTs are the future. For _some things_. If databases were invented today, I'm certain most of the effort would be spent developing CRDT databases or something with “offline algorithms” built-in. But tech is a real-world demonstration of the Lindy effect: the longer something has existed, the longer it's likely to exist in the future. That's why we bet on Postgres - with more than 30 years history, it's here to stay.","level":1,"lines":[63,64],"children":[{"type":"text","content":"I personally believe CRDTs are the future. For ","level":0},{"type":"em_open","level":0},{"type":"text","content":"some things","level":1},{"type":"em_close","level":0},{"type":"text","content":". If databases were invented today, I'm certain most of the effort would be spent developing CRDT databases or something with “offline algorithms” built-in. But tech is a real-world demonstration of the Lindy effect: the longer something has existed, the longer it's likely to exist in the future. That's why we bet on Postgres - with more than 30 years history, it's here to stay.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[65,66],"level":0},{"type":"inline","content":"Faced with this reality, we should consider how to solve _offline with Postgres_ and where CRDTs might fit into that picture.","level":1,"lines":[65,66],"children":[{"type":"text","content":"Faced with this reality, we should consider how to solve ","level":0},{"type":"em_open","level":0},{"type":"text","content":"offline with Postgres","level":1},{"type":"em_close","level":0},{"type":"text","content":" and where CRDTs might fit into that picture.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[67,68],"level":0},{"type":"inline","content":"For a long time I thought there could be a way to shoehorn Postgres row-level data into a CRDT, to give _truly_ offline support. This may even still be [possible](https://electric-sql.com/), and it's one of the ideas we'll continue to pursue. But Postgres is a rich and evolving ecosystem, and I don't know whether it will be possible to -","level":1,"lines":[67,68],"children":[{"type":"text","content":"For a long time I thought there could be a way to shoehorn Postgres row-level data into a CRDT, to give ","level":0},{"type":"em_open","level":0},{"type":"text","content":"truly","level":1},{"type":"em_close","level":0},{"type":"text","content":" offline support. This may even still be ","level":0},{"type":"link_open","href":"https://electric-sql.com/","title":"","level":0},{"type":"text","content":"possible","level":1},{"type":"link_close","level":0},{"type":"text","content":", and it's one of the ideas we'll continue to pursue. But Postgres is a rich and evolving ecosystem, and I don't know whether it will be possible to -","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[69,70],"level":0},{"type":"inline","content":"a) find a merge strategy for an entire row, while simultaneously:","level":1,"lines":[69,70],"children":[{"type":"text","content":"a) find a merge strategy for an entire row, while simultaneously:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[71,72],"level":0},{"type":"inline","content":"b) finding a merge strategy for every data type _within_ that row (especially with the number of data types available through extensions)","level":1,"lines":[71,72],"children":[{"type":"text","content":"b) finding a merge strategy for every data type ","level":0},{"type":"em_open","level":0},{"type":"text","content":"within","level":1},{"type":"em_close","level":0},{"type":"text","content":" that row (especially with the number of data types available through extensions)","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[73,74],"level":0},{"type":"inline","content":"It's possible that developers will need to be selective about their “level” of offline support, at least if they plan to use an “incumbent” databases. For the cases, a simple “last write wins” strategy is probably acceptable (see the excellent [Replicache](https://doc.replicache.dev/examples/repliear) and [Watermelon](https://nozbe.github.io/WatermelonDB/) libraries), but there will be important pieces of their application where it is not.","level":1,"lines":[73,74],"children":[{"type":"text","content":"It's possible that developers will need to be selective about their “level” of offline support, at least if they plan to use an “incumbent” databases. For the cases, a simple “last write wins” strategy is probably acceptable (see the excellent ","level":0},{"type":"link_open","href":"https://doc.replicache.dev/examples/repliear","title":"","level":0},{"type":"text","content":"Replicache","level":1},{"type":"link_close","level":0},{"type":"text","content":" and ","level":0},{"type":"link_open","href":"https://nozbe.github.io/WatermelonDB/","title":"","level":0},{"type":"text","content":"Watermelon","level":1},{"type":"link_close","level":0},{"type":"text","content":" libraries), but there will be important pieces of their application where it is not.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[75,76],"level":0},{"type":"inline","content":"Take this table of blog posts as an example:","level":1,"lines":[75,76],"children":[{"type":"text","content":"Take this table of blog posts as an example:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"fence","params":"sql","content":"create table posts (\n  id serial primary key,\n  title text,\n  content text default ''\n);\n","lines":[77,84],"level":0},{"type":"paragraph_open","tight":false,"lines":[85,86],"level":0},{"type":"inline","content":"Perhaps it's not that important if the `title` has a “last write wins” strategy, because it's rarely updated and less likely to have a merge conflict. But it is critical to use a smarter algorithm for the `content` of the blog post, especially in a team where multiple users are editing a blog post at the same time.","level":1,"lines":[85,86],"children":[{"type":"text","content":"Perhaps it's not that important if the ","level":0},{"type":"code","content":"title","block":false,"level":0},{"type":"text","content":" has a “last write wins” strategy, because it's rarely updated and less likely to have a merge conflict. But it is critical to use a smarter algorithm for the ","level":0},{"type":"code","content":"content","block":false,"level":0},{"type":"text","content":" of the blog post, especially in a team where multiple users are editing a blog post at the same time.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[87,88],"level":0},{"type":"inline","content":"That's a lot of background to get to what you probably want to know about:","level":1,"lines":[87,88],"children":[{"type":"text","content":"That's a lot of background to get to what you probably want to know about:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[89,90],"level":0},{"type":"inline","content":"[Postgres CRDT extension](#postgres-crdt-extension)","level":1,"lines":[89,90],"children":[{"type":"text","content":"Postgres CRDT extension","level":0}],"lvl":2,"i":2,"seen":0,"slug":"postgres-crdt-extension"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[91,92],"level":0},{"type":"inline","content":"`pg_crdt` is an extension which adds CRDT support to Postgres as a data type. For example, using our table from above:","level":1,"lines":[91,92],"children":[{"type":"code","content":"pg_crdt","block":false,"level":0},{"type":"text","content":" is an extension which adds CRDT support to Postgres as a data type. For example, using our table from above:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"fence","params":"sql","content":"create table posts (\n  id serial primary key,\n  title text,\n  content crdt.ydoc default crdt.new_ydoc()\n);\n","lines":[93,100],"level":0},{"type":"paragraph_open","tight":false,"lines":[101,102],"level":0},{"type":"inline","content":"The `content` column is now a [Yjs Doc](https://docs.yjs.dev/api/y.doc). Updates to this column are _commutative_ and _idempotent_. This means that they can be applied in any order and multiple times, and the result will always be the same. Two people can edit the blog content at the same time, and they won't have any issues when their changes are saved in the database.","level":1,"lines":[101,102],"children":[{"type":"text","content":"The ","level":0},{"type":"code","content":"content","block":false,"level":0},{"type":"text","content":" column is now a ","level":0},{"type":"link_open","href":"https://docs.yjs.dev/api/y.doc","title":"","level":0},{"type":"text","content":"Yjs Doc","level":1},{"type":"link_close","level":0},{"type":"text","content":". Updates to this column are ","level":0},{"type":"em_open","level":0},{"type":"text","content":"commutative","level":1},{"type":"em_close","level":0},{"type":"text","content":" and ","level":0},{"type":"em_open","level":0},{"type":"text","content":"idempotent","level":1},{"type":"em_close","level":0},{"type":"text","content":". This means that they can be applied in any order and multiple times, and the result will always be the same. Two people can edit the blog content at the same time, and they won't have any issues when their changes are saved in the database.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":3,"lines":[103,104],"level":0},{"type":"inline","content":"[Support for Yjs, Automerge, and beyond](#support-for-yjs-automerge-and-beyond)","level":1,"lines":[103,104],"children":[{"type":"text","content":"Support for Yjs, Automerge, and beyond","level":0}],"lvl":3,"i":3,"seen":0,"slug":"support-for-yjs-automerge-and-beyond"},{"type":"heading_close","hLevel":3,"level":0},{"type":"paragraph_open","tight":false,"lines":[105,106],"level":0},{"type":"inline","content":"The Yjs and Automerge teams have done some excellent work to create Rust libraries for their CRDTs implementations. It was relatively trivial to wrap the libraries into a Postgres extension using the [pgx](https://github.com/tcdi/pgx) framework.","level":1,"lines":[105,106],"children":[{"type":"text","content":"The Yjs and Automerge teams have done some excellent work to create Rust libraries for their CRDTs implementations. It was relatively trivial to wrap the libraries into a Postgres extension using the ","level":0},{"type":"link_open","href":"https://github.com/tcdi/pgx","title":"","level":0},{"type":"text","content":"pgx","level":1},{"type":"link_close","level":0},{"type":"text","content":" framework.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[107,108],"level":0},{"type":"inline","content":"At this stage it makes sense to give developers as many choices as possible in one extension. The CRDT space is nascent the algorithms are rapidly changing.","level":1,"lines":[107,108],"children":[{"type":"text","content":"At this stage it makes sense to give developers as many choices as possible in one extension. The CRDT space is nascent the algorithms are rapidly changing.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[109,110],"level":0},{"type":"inline","content":"Importantly, both Yjs and Automerge have _JavaScript_ and Rust implementations, which means they work natively in both a browser and a Postgres environment. Since collaborative applications are largely a client-side problem, CRDTs are more useful for developers if they have robust JavaScript libraries. In the future, if this extension becomes the approach we take, then Supabase will focus some resources on building Yjs/Automerge libraries for mobile devices too (Swift for iOS, Kotlin for Android).","level":1,"lines":[109,110],"children":[{"type":"text","content":"Importantly, both Yjs and Automerge have ","level":0},{"type":"em_open","level":0},{"type":"text","content":"JavaScript","level":1},{"type":"em_close","level":0},{"type":"text","content":" and Rust implementations, which means they work natively in both a browser and a Postgres environment. Since collaborative applications are largely a client-side problem, CRDTs are more useful for developers if they have robust JavaScript libraries. In the future, if this extension becomes the approach we take, then Supabase will focus some resources on building Yjs/Automerge libraries for mobile devices too (Swift for iOS, Kotlin for Android).","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[111,112],"level":0},{"type":"inline","content":"[Why not build this into Realtime?](#why-not-build-this-into-realtime)","level":1,"lines":[111,112],"children":[{"type":"text","content":"Why not build this into Realtime?","level":0}],"lvl":2,"i":4,"seen":0,"slug":"why-not-build-this-into-realtime"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[113,114],"level":0},{"type":"inline","content":"An alternative approach for CRDT support in Supabase is to build support directly into [Realtime](https://github.com/supabase/realtime) and use it as an Authoritative server. In this scenario, Realtime would serialize the CRDT and save it to Postgres (probably as a `bytea` data type). Yjs has the concept of [Providers](https://github.com/yjs/yjs#providers) which would facilitate this. You can see the difference between the approaches in the diagram below - on the left, Realtime acts as the “middleman” for saving the CRDT in the database, whereas on the right the CRDT is pushed directly to the database, and Realtime receives updates from Postgres. (Note also that clients can send peer-to-peer updates.)","level":1,"lines":[113,114],"children":[{"type":"text","content":"An alternative approach for CRDT support in Supabase is to build support directly into ","level":0},{"type":"link_open","href":"https://github.com/supabase/realtime","title":"","level":0},{"type":"text","content":"Realtime","level":1},{"type":"link_close","level":0},{"type":"text","content":" and use it as an Authoritative server. In this scenario, Realtime would serialize the CRDT and save it to Postgres (probably as a ","level":0},{"type":"code","content":"bytea","block":false,"level":0},{"type":"text","content":" data type). Yjs has the concept of ","level":0},{"type":"link_open","href":"https://github.com/yjs/yjs#providers","title":"","level":0},{"type":"text","content":"Providers","level":1},{"type":"link_close","level":0},{"type":"text","content":" which would facilitate this. You can see the difference between the approaches in the diagram below - on the left, Realtime acts as the “middleman” for saving the CRDT in the database, whereas on the right the CRDT is pushed directly to the database, and Realtime receives updates from Postgres. (Note also that clients can send peer-to-peer updates.)","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[115,116],"level":0},{"type":"inline","content":"![Realtime as an authority](/images/blog/crdt/authority.png)","level":1,"lines":[115,116],"children":[{"type":"image","src":"/images/blog/crdt/authority.png","title":"","alt":"Realtime as an authority","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[117,118],"level":0},{"type":"inline","content":"This might still be our best option, but it should not be our first attempt. If we make Realtime the authority, it strongly couples developers to the Supabase infrastructure. By placing the CRDT into the database, it simplifies the architecture, enables other tools (like Debezium), and provides the possibility to update the database directly (for semi-realtime events like counters or page-views).","level":1,"lines":[117,118],"children":[{"type":"text","content":"This might still be our best option, but it should not be our first attempt. If we make Realtime the authority, it strongly couples developers to the Supabase infrastructure. By placing the CRDT into the database, it simplifies the architecture, enables other tools (like Debezium), and provides the possibility to update the database directly (for semi-realtime events like counters or page-views).","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[119,120],"level":0},{"type":"inline","content":"![External providers](/images/blog/crdt/semi-realtime.png)","level":1,"lines":[119,120],"children":[{"type":"image","src":"/images/blog/crdt/semi-realtime.png","title":"","alt":"External providers","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"paragraph_open","tight":false,"lines":[121,122],"level":0},{"type":"inline","content":"The Realtime engine seems like a great _compliment_ for `pg_crdt`, but before we put it into production we need to solve a few (major) limitations.","level":1,"lines":[121,122],"children":[{"type":"text","content":"The Realtime engine seems like a great ","level":0},{"type":"em_open","level":0},{"type":"text","content":"compliment","level":1},{"type":"em_close","level":0},{"type":"text","content":" for ","level":0},{"type":"code","content":"pg_crdt","block":false,"level":0},{"type":"text","content":", but before we put it into production we need to solve a few (major) limitations.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[123,124],"level":0},{"type":"inline","content":"[Limitations](#limitations)","level":1,"lines":[123,124],"children":[{"type":"text","content":"Limitations","level":0}],"lvl":2,"i":5,"seen":0,"slug":"limitations"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[125,126],"level":0},{"type":"inline","content":"These are a few of the _known_ limitations:","level":1,"lines":[125,126],"children":[{"type":"text","content":"These are a few of the ","level":0},{"type":"em_open","level":0},{"type":"text","content":"known","level":1},{"type":"em_close","level":0},{"type":"text","content":" limitations:","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"bullet_list_open","lines":[127,131],"level":0},{"type":"list_item_open","lines":[127,128],"level":1},{"type":"paragraph_open","tight":true,"lines":[127,128],"level":2},{"type":"inline","content":"Realtime broadcasts database changes from the Postgres write ahead log (WAL). The WAL includes a complete copy of the the underlying data so small updates cause the entire document to broadcast to all collaborators","level":3,"lines":[127,128],"children":[{"type":"text","content":"Realtime broadcasts database changes from the Postgres write ahead log (WAL). The WAL includes a complete copy of the the underlying data so small updates cause the entire document to broadcast to all collaborators","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[128,129],"level":1},{"type":"paragraph_open","tight":true,"lines":[128,129],"level":2},{"type":"inline","content":"Frequently updated CRDTs produce a lot of WAL and dead tuples","level":3,"lines":[128,129],"children":[{"type":"text","content":"Frequently updated CRDTs produce a lot of WAL and dead tuples","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[129,131],"level":1},{"type":"paragraph_open","tight":true,"lines":[129,130],"level":2},{"type":"inline","content":"Large CRDT types in Postgres generate significant serialization/deserialization overhead on-update.","level":3,"lines":[129,130],"children":[{"type":"text","content":"Large CRDT types in Postgres generate significant serialization/deserialization overhead on-update.","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"bullet_list_close","level":0},{"type":"paragraph_open","tight":false,"lines":[131,132],"level":0},{"type":"inline","content":"We're likely to discover more (no doubt from a few friendly HN comments).","level":1,"lines":[131,132],"children":[{"type":"text","content":"We're likely to discover more (no doubt from a few friendly HN comments).","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[133,134],"level":0},{"type":"inline","content":"[Next steps](#next-steps)","level":1,"lines":[133,134],"children":[{"type":"text","content":"Next steps","level":0}],"lvl":2,"i":6,"seen":0,"slug":"next-steps"},{"type":"heading_close","hLevel":2,"level":0},{"type":"paragraph_open","tight":false,"lines":[135,136],"level":0},{"type":"inline","content":"If you want to help with `pg_crdt` the best way is to get involved in the GitHub repo. We have enabled [Discussions](https://github.com/supabase/pg_crdt/discussions) for any and all ideas. If you have experience with CRDTs and you like this approach, don't hesitate to contact one of the team.","level":1,"lines":[135,136],"children":[{"type":"text","content":"If you want to help with ","level":0},{"type":"code","content":"pg_crdt","block":false,"level":0},{"type":"text","content":" the best way is to get involved in the GitHub repo. We have enabled ","level":0},{"type":"link_open","href":"https://github.com/supabase/pg_crdt/discussions","title":"","level":0},{"type":"text","content":"Discussions","level":1},{"type":"link_close","level":0},{"type":"text","content":" for any and all ideas. If you have experience with CRDTs and you like this approach, don't hesitate to contact one of the team.","level":0}]},{"type":"paragraph_close","tight":false,"level":0},{"type":"heading_open","hLevel":2,"lines":[137,138],"level":0},{"type":"inline","content":"[More Launch Week 6](#more-launch-week-6)","level":1,"lines":[137,138],"children":[{"type":"text","content":"More Launch Week 6","level":0}],"lvl":2,"i":7,"seen":0,"slug":"more-launch-week-6"},{"type":"heading_close","hLevel":2,"level":0},{"type":"bullet_list_open","lines":[139,148],"level":0},{"type":"list_item_open","lines":[139,140],"level":1},{"type":"paragraph_open","tight":true,"lines":[139,140],"level":2},{"type":"inline","content":"[Day 1: New Supabase Docs, built with Next.js](https://supabase.com/blog/new-supabase-docs-built-with-nextjs)","level":3,"lines":[139,140],"children":[{"type":"link_open","href":"https://supabase.com/blog/new-supabase-docs-built-with-nextjs","title":"","level":0},{"type":"text","content":"Day 1: New Supabase Docs, built with Next.js","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[140,141],"level":1},{"type":"paragraph_open","tight":true,"lines":[140,141],"level":2},{"type":"inline","content":"[Day 2: Supabase Storage v2: Image resizing and Smart CDN](https://supabase.com/blog/storage-image-resizing-smart-cdn)","level":3,"lines":[140,141],"children":[{"type":"link_open","href":"https://supabase.com/blog/storage-image-resizing-smart-cdn","title":"","level":0},{"type":"text","content":"Day 2: Supabase Storage v2: Image resizing and Smart CDN","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[141,142],"level":1},{"type":"paragraph_open","tight":true,"lines":[141,142],"level":2},{"type":"inline","content":"[Day 3: Multi-factor Authentication via Row Level Security Enforcement](https://supabase.com/blog/mfa-auth-via-rls)","level":3,"lines":[141,142],"children":[{"type":"link_open","href":"https://supabase.com/blog/mfa-auth-via-rls","title":"","level":0},{"type":"text","content":"Day 3: Multi-factor Authentication via Row Level Security Enforcement","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[142,143],"level":1},{"type":"paragraph_open","tight":true,"lines":[142,143],"level":2},{"type":"inline","content":"[Day 4: Supabase Wrappers, a Postgres FDW framework written in Rust](https://supabase.com/blog/postgres-foreign-data-wrappers-rust)","level":3,"lines":[142,143],"children":[{"type":"link_open","href":"https://supabase.com/blog/postgres-foreign-data-wrappers-rust","title":"","level":0},{"type":"text","content":"Day 4: Supabase Wrappers, a Postgres FDW framework written in Rust","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[143,144],"level":1},{"type":"paragraph_open","tight":true,"lines":[143,144],"level":2},{"type":"inline","content":"[Day 5: Supabase Vault is now in Beta](https://supabase.com/blog/vault-now-in-beta)","level":3,"lines":[143,144],"children":[{"type":"link_open","href":"https://supabase.com/blog/vault-now-in-beta","title":"","level":0},{"type":"text","content":"Day 5: Supabase Vault is now in Beta","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[144,145],"level":1},{"type":"paragraph_open","tight":true,"lines":[144,145],"level":2},{"type":"inline","content":"[Community Day](https://supabase.com/blog/launch-week-6-community-day)","level":3,"lines":[144,145],"children":[{"type":"link_open","href":"https://supabase.com/blog/launch-week-6-community-day","title":"","level":0},{"type":"text","content":"Community Day","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[145,146],"level":1},{"type":"paragraph_open","tight":true,"lines":[145,146],"level":2},{"type":"inline","content":"[Point in Time Recovery is now available](https://supabase.com/blog/postgres-point-in-time-recovery)","level":3,"lines":[145,146],"children":[{"type":"link_open","href":"https://supabase.com/blog/postgres-point-in-time-recovery","title":"","level":0},{"type":"text","content":"Point in Time Recovery is now available","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[146,147],"level":1},{"type":"paragraph_open","tight":true,"lines":[146,147],"level":2},{"type":"inline","content":"[Custom Domain Names are now available](https://supabase.com/blog/custom-domain-names)","level":3,"lines":[146,147],"children":[{"type":"link_open","href":"https://supabase.com/blog/custom-domain-names","title":"","level":0},{"type":"text","content":"Custom Domain Names are now available","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"list_item_open","lines":[147,148],"level":1},{"type":"paragraph_open","tight":true,"lines":[147,148],"level":2},{"type":"inline","content":"[Wrap Up: everything we shipped](https://supabase.com/blog/launch-week-6-wrap-up)","level":3,"lines":[147,148],"children":[{"type":"link_open","href":"https://supabase.com/blog/launch-week-6-wrap-up","title":"","level":0},{"type":"text","content":"Wrap Up: everything we shipped","level":1},{"type":"link_close","level":0}]},{"type":"paragraph_close","tight":true,"level":2},{"type":"list_item_close","level":1},{"type":"bullet_list_close","level":0}],"content":"- [What's a CRDT?](#whats-a-crdt)\n- [Offline philosophy](#offline-philosophy)\n- [Postgres CRDT extension](#postgres-crdt-extension)\n- [Why not build this into Realtime?](#why-not-build-this-into-realtime)\n- [Limitations](#limitations)\n- [Next steps](#next-steps)\n- [More Launch Week 6](#more-launch-week-6)"}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"postgres-crdt"},"buildId":"NqpQLGJ_BIsAXmbu4Azvp","assetPrefix":"https://frontend-assets.supabase.com/www/a343e864a02b","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>